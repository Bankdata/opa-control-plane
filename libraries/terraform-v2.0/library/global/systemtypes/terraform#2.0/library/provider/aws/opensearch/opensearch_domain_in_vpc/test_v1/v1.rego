package global.systemtypes["terraform:2.0"].library.provider.aws.opensearch.opensearch_domain_in_vpc.test_v1

import data.global.systemtypes["terraform:2.0"].library.provider.aws.opensearch.opensearch_domain_in_vpc.v1

test_opensearch_domain_in_vpc_good {
	vpc_options := [{}]
	in := input_opensearch_domain_with_vpc_options_block(vpc_options)
	actual := v1.prohibit_opensearch_domains_not_in_vpc with input as in

	count(actual) == 0
}

test_opensearch_domain_in_vpc_bad {
	vpc_options := []
	in := input_opensearch_domain_with_vpc_options_block(vpc_options)
	actual := v1.prohibit_opensearch_domains_not_in_vpc with input as in

	count(actual) == 1
}

test_opensearch_domain_has_no_vpc_block_bad {
	in := input_opensearch_domain_without_vpc_options_block
	actual := v1.prohibit_opensearch_domains_not_in_vpc with input as in

	count(actual) == 1
}

input_opensearch_domain_with_vpc_options_block(value) := x {
	x := {
		"format_version": "1.1",
		"terraform_version": "1.2.7",
		"planned_values": {"root_module": {"child_modules": [{
			"resources": [
				{
					"address": "module.sample_opensearch_domain.aws_iam_service_linked_role.es",
					"mode": "managed",
					"type": "aws_iam_service_linked_role",
					"name": "es",
					"provider_name": "registry.terraform.io/hashicorp/aws",
					"schema_version": 0,
					"values": {
						"aws_service_name": "opensearchservice.amazonaws.com",
						"custom_suffix": null,
						"description": null,
						"tags": null,
					},
					"sensitive_values": {"tags_all": {}},
				},
				{
					"address": "module.sample_opensearch_domain.aws_internet_gateway.igw",
					"mode": "managed",
					"type": "aws_internet_gateway",
					"name": "igw",
					"provider_name": "registry.terraform.io/hashicorp/aws",
					"schema_version": 0,
					"values": {
						"tags": {"Name": "vpc_igw"},
						"tags_all": {"Name": "vpc_igw"},
						"timeouts": null,
					},
					"sensitive_values": {
						"tags": {},
						"tags_all": {},
					},
				},
				{
					"address": "module.sample_opensearch_domain.aws_opensearch_domain.example",
					"mode": "managed",
					"type": "aws_opensearch_domain",
					"name": "example",
					"provider_name": "registry.terraform.io/hashicorp/aws",
					"schema_version": 0,
					"values": {
						"cluster_config": [{
							"dedicated_master_count": null,
							"dedicated_master_enabled": false,
							"dedicated_master_type": null,
							"instance_count": 1,
							"instance_type": "r4.large.search",
							"warm_count": null,
							"warm_enabled": null,
							"warm_type": null,
							"zone_awareness_config": [],
							"zone_awareness_enabled": null,
						}],
						"cognito_options": [],
						"domain_name": "opensearch-domain",
						"ebs_options": [{
							"ebs_enabled": true,
							"volume_size": 10,
						}],
						"encrypt_at_rest": [{"enabled": true}],
						"engine_version": "OpenSearch_1.1",
						"log_publishing_options": [],
						"node_to_node_encryption": [{"enabled": true}],
						"snapshot_options": [],
						"tags": {"Domain": "TestDomain"},
						"tags_all": {"Domain": "TestDomain"},
						"timeouts": null,
						"vpc_options": value,
					},
					"sensitive_values": {
						"advanced_options": {},
						"advanced_security_options": [],
						"auto_tune_options": [],
						"cluster_config": [{
							"cold_storage_options": [],
							"zone_awareness_config": [],
						}],
						"cognito_options": [],
						"domain_endpoint_options": [],
						"ebs_options": [{}],
						"encrypt_at_rest": [{}],
						"log_publishing_options": [],
						"node_to_node_encryption": [{}],
						"snapshot_options": [],
						"tags": {},
						"tags_all": {},
						"vpc_options": [{
							"availability_zones": [],
							"security_group_ids": [],
							"subnet_ids": [],
						}],
					},
				},
				{
					"address": "module.sample_opensearch_domain.aws_route_table.vpc_rt",
					"mode": "managed",
					"type": "aws_route_table",
					"name": "vpc_rt",
					"provider_name": "registry.terraform.io/hashicorp/aws",
					"schema_version": 0,
					"values": {
						"route": [{
							"carrier_gateway_id": "",
							"cidr_block": "0.0.0.0/0",
							"core_network_arn": "",
							"destination_prefix_list_id": "",
							"egress_only_gateway_id": "",
							"instance_id": "",
							"ipv6_cidr_block": "",
							"local_gateway_id": "",
							"nat_gateway_id": "",
							"network_interface_id": "",
							"transit_gateway_id": "",
							"vpc_endpoint_id": "",
							"vpc_peering_connection_id": "",
						}],
						"tags": {"Name": "vpc_rt"},
						"tags_all": {"Name": "vpc_rt"},
						"timeouts": null,
					},
					"sensitive_values": {
						"propagating_vgws": [],
						"route": [{}],
						"tags": {},
						"tags_all": {},
					},
				},
				{
					"address": "module.sample_opensearch_domain.aws_security_group.os",
					"mode": "managed",
					"type": "aws_security_group",
					"name": "os",
					"provider_name": "registry.terraform.io/hashicorp/aws",
					"schema_version": 1,
					"values": {
						"description": "Managed by Terraform",
						"ingress": [{
							"description": "",
							"from_port": 443,
							"ipv6_cidr_blocks": [],
							"prefix_list_ids": [],
							"protocol": "tcp",
							"security_groups": [],
							"self": false,
							"to_port": 443,
						}],
						"revoke_rules_on_delete": false,
						"tags": null,
						"timeouts": null,
					},
					"sensitive_values": {
						"egress": [],
						"ingress": [{
							"cidr_blocks": [],
							"ipv6_cidr_blocks": [],
							"prefix_list_ids": [],
							"security_groups": [],
						}],
						"tags_all": {},
					},
				},
				{
					"address": "module.sample_opensearch_domain.aws_subnet.subnet_a",
					"mode": "managed",
					"type": "aws_subnet",
					"name": "subnet_a",
					"provider_name": "registry.terraform.io/hashicorp/aws",
					"schema_version": 1,
					"values": {
						"assign_ipv6_address_on_creation": false,
						"availability_zone": "us-west-2a",
						"cidr_block": "178.0.10.0/24",
						"customer_owned_ipv4_pool": null,
						"enable_dns64": false,
						"enable_resource_name_dns_a_record_on_launch": false,
						"enable_resource_name_dns_aaaa_record_on_launch": false,
						"ipv6_cidr_block": null,
						"ipv6_native": false,
						"map_customer_owned_ip_on_launch": null,
						"map_public_ip_on_launch": false,
						"outpost_arn": null,
						"tags": {"Name": "vpc-subnet-2a"},
						"tags_all": {"Name": "vpc-subnet-2a"},
						"timeouts": null,
					},
					"sensitive_values": {
						"tags": {},
						"tags_all": {},
					},
				},
				{
					"address": "module.sample_opensearch_domain.aws_subnet.subnet_b",
					"mode": "managed",
					"type": "aws_subnet",
					"name": "subnet_b",
					"provider_name": "registry.terraform.io/hashicorp/aws",
					"schema_version": 1,
					"values": {
						"assign_ipv6_address_on_creation": false,
						"availability_zone": "us-west-2b",
						"cidr_block": "178.0.100.0/24",
						"customer_owned_ipv4_pool": null,
						"enable_dns64": false,
						"enable_resource_name_dns_a_record_on_launch": false,
						"enable_resource_name_dns_aaaa_record_on_launch": false,
						"ipv6_cidr_block": null,
						"ipv6_native": false,
						"map_customer_owned_ip_on_launch": null,
						"map_public_ip_on_launch": false,
						"outpost_arn": null,
						"tags": {"Name": "vpc-subnet-2b"},
						"tags_all": {"Name": "vpc-subnet-2b"},
						"timeouts": null,
					},
					"sensitive_values": {
						"tags": {},
						"tags_all": {},
					},
				},
				{
					"address": "module.sample_opensearch_domain.aws_vpc.app_vpc",
					"mode": "managed",
					"type": "aws_vpc",
					"name": "app_vpc",
					"provider_name": "registry.terraform.io/hashicorp/aws",
					"schema_version": 1,
					"values": {
						"assign_generated_ipv6_cidr_block": null,
						"cidr_block": "178.0.0.0/16",
						"enable_dns_support": true,
						"instance_tenancy": "default",
						"ipv4_ipam_pool_id": null,
						"ipv4_netmask_length": null,
						"ipv6_ipam_pool_id": null,
						"ipv6_netmask_length": null,
						"tags": {"Name": "app-vpc"},
						"tags_all": {"Name": "app-vpc"},
					},
					"sensitive_values": {
						"tags": {},
						"tags_all": {},
					},
				},
				{
					"address": "module.sample_opensearch_domain.data.aws_vpc.selected",
					"mode": "data",
					"type": "aws_vpc",
					"name": "selected",
					"provider_name": "registry.terraform.io/hashicorp/aws",
					"schema_version": 0,
					"values": {"filter": []},
					"sensitive_values": {
						"cidr_block_associations": [],
						"filter": [],
						"tags": {},
						"timeouts": {},
					},
				},
			],
			"address": "module.sample_opensearch_domain",
		}]}},
		"resource_changes": [
			{
				"address": "module.sample_opensearch_domain.aws_iam_service_linked_role.es",
				"module_address": "module.sample_opensearch_domain",
				"mode": "managed",
				"type": "aws_iam_service_linked_role",
				"name": "es",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"aws_service_name": "opensearchservice.amazonaws.com",
						"custom_suffix": null,
						"description": null,
						"tags": null,
					},
					"after_unknown": {
						"arn": true,
						"create_date": true,
						"id": true,
						"name": true,
						"path": true,
						"tags_all": true,
						"unique_id": true,
					},
					"before_sensitive": false,
					"after_sensitive": {"tags_all": {}},
				},
			},
			{
				"address": "module.sample_opensearch_domain.aws_internet_gateway.igw",
				"module_address": "module.sample_opensearch_domain",
				"mode": "managed",
				"type": "aws_internet_gateway",
				"name": "igw",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"tags": {"Name": "vpc_igw"},
						"tags_all": {"Name": "vpc_igw"},
						"timeouts": null,
					},
					"after_unknown": {
						"arn": true,
						"id": true,
						"owner_id": true,
						"tags": {},
						"tags_all": {},
						"vpc_id": true,
					},
					"before_sensitive": false,
					"after_sensitive": {
						"tags": {},
						"tags_all": {},
					},
				},
			},
			{
				"address": "module.sample_opensearch_domain.aws_opensearch_domain.example",
				"module_address": "module.sample_opensearch_domain",
				"mode": "managed",
				"type": "aws_opensearch_domain",
				"name": "example",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"cluster_config": [{
							"dedicated_master_count": null,
							"dedicated_master_enabled": false,
							"dedicated_master_type": null,
							"instance_count": 1,
							"instance_type": "r4.large.search",
							"warm_count": null,
							"warm_enabled": null,
							"warm_type": null,
							"zone_awareness_config": [],
							"zone_awareness_enabled": null,
						}],
						"cognito_options": [],
						"domain_name": "opensearch-domain",
						"ebs_options": [{
							"ebs_enabled": true,
							"volume_size": 10,
						}],
						"encrypt_at_rest": [{"enabled": true}],
						"engine_version": "OpenSearch_1.1",
						"log_publishing_options": [],
						"node_to_node_encryption": [{"enabled": true}],
						"snapshot_options": [],
						"tags": {"Domain": "TestDomain"},
						"tags_all": {"Domain": "TestDomain"},
						"timeouts": null,
						"vpc_options": value,
					},
					"after_unknown": {
						"access_policies": true,
						"advanced_options": true,
						"advanced_security_options": true,
						"arn": true,
						"auto_tune_options": true,
						"cluster_config": [{
							"cold_storage_options": true,
							"zone_awareness_config": [],
						}],
						"cognito_options": [],
						"domain_endpoint_options": true,
						"domain_id": true,
						"ebs_options": [{
							"iops": true,
							"throughput": true,
							"volume_type": true,
						}],
						"encrypt_at_rest": [{"kms_key_id": true}],
						"endpoint": true,
						"id": true,
						"kibana_endpoint": true,
						"log_publishing_options": [],
						"node_to_node_encryption": [{}],
						"snapshot_options": [],
						"tags": {},
						"tags_all": {},
						"vpc_options": [{
							"availability_zones": true,
							"security_group_ids": true,
							"subnet_ids": true,
							"vpc_id": true,
						}],
					},
					"before_sensitive": false,
					"after_sensitive": {
						"advanced_options": {},
						"advanced_security_options": [],
						"auto_tune_options": [],
						"cluster_config": [{
							"cold_storage_options": [],
							"zone_awareness_config": [],
						}],
						"cognito_options": [],
						"domain_endpoint_options": [],
						"ebs_options": [{}],
						"encrypt_at_rest": [{}],
						"log_publishing_options": [],
						"node_to_node_encryption": [{}],
						"snapshot_options": [],
						"tags": {},
						"tags_all": {},
						"vpc_options": [{
							"availability_zones": [],
							"security_group_ids": [],
							"subnet_ids": [],
						}],
					},
				},
			},
			{
				"address": "module.sample_opensearch_domain.aws_route_table.vpc_rt",
				"module_address": "module.sample_opensearch_domain",
				"mode": "managed",
				"type": "aws_route_table",
				"name": "vpc_rt",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"route": [{
							"carrier_gateway_id": "",
							"cidr_block": "0.0.0.0/0",
							"core_network_arn": "",
							"destination_prefix_list_id": "",
							"egress_only_gateway_id": "",
							"instance_id": "",
							"ipv6_cidr_block": "",
							"local_gateway_id": "",
							"nat_gateway_id": "",
							"network_interface_id": "",
							"transit_gateway_id": "",
							"vpc_endpoint_id": "",
							"vpc_peering_connection_id": "",
						}],
						"tags": {"Name": "vpc_rt"},
						"tags_all": {"Name": "vpc_rt"},
						"timeouts": null,
					},
					"after_unknown": {
						"arn": true,
						"id": true,
						"owner_id": true,
						"propagating_vgws": true,
						"route": [{"gateway_id": true}],
						"tags": {},
						"tags_all": {},
						"vpc_id": true,
					},
					"before_sensitive": false,
					"after_sensitive": {
						"propagating_vgws": [],
						"route": [{}],
						"tags": {},
						"tags_all": {},
					},
				},
			},
			{
				"address": "module.sample_opensearch_domain.aws_security_group.os",
				"module_address": "module.sample_opensearch_domain",
				"mode": "managed",
				"type": "aws_security_group",
				"name": "os",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"description": "Managed by Terraform",
						"ingress": [{
							"description": "",
							"from_port": 443,
							"ipv6_cidr_blocks": [],
							"prefix_list_ids": [],
							"protocol": "tcp",
							"security_groups": [],
							"self": false,
							"to_port": 443,
						}],
						"revoke_rules_on_delete": false,
						"tags": null,
						"timeouts": null,
					},
					"after_unknown": {
						"arn": true,
						"egress": true,
						"id": true,
						"ingress": [{
							"cidr_blocks": true,
							"ipv6_cidr_blocks": [],
							"prefix_list_ids": [],
							"security_groups": [],
						}],
						"name": true,
						"name_prefix": true,
						"owner_id": true,
						"tags_all": true,
						"vpc_id": true,
					},
					"before_sensitive": false,
					"after_sensitive": {
						"egress": [],
						"ingress": [{
							"cidr_blocks": [],
							"ipv6_cidr_blocks": [],
							"prefix_list_ids": [],
							"security_groups": [],
						}],
						"tags_all": {},
					},
				},
			},
			{
				"address": "module.sample_opensearch_domain.aws_subnet.subnet_a",
				"module_address": "module.sample_opensearch_domain",
				"mode": "managed",
				"type": "aws_subnet",
				"name": "subnet_a",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"assign_ipv6_address_on_creation": false,
						"availability_zone": "us-west-2a",
						"cidr_block": "178.0.10.0/24",
						"customer_owned_ipv4_pool": null,
						"enable_dns64": false,
						"enable_resource_name_dns_a_record_on_launch": false,
						"enable_resource_name_dns_aaaa_record_on_launch": false,
						"ipv6_cidr_block": null,
						"ipv6_native": false,
						"map_customer_owned_ip_on_launch": null,
						"map_public_ip_on_launch": false,
						"outpost_arn": null,
						"tags": {"Name": "vpc-subnet-2a"},
						"tags_all": {"Name": "vpc-subnet-2a"},
						"timeouts": null,
					},
					"after_unknown": {
						"arn": true,
						"availability_zone_id": true,
						"id": true,
						"ipv6_cidr_block_association_id": true,
						"owner_id": true,
						"private_dns_hostname_type_on_launch": true,
						"tags": {},
						"tags_all": {},
						"vpc_id": true,
					},
					"before_sensitive": false,
					"after_sensitive": {
						"tags": {},
						"tags_all": {},
					},
				},
			},
			{
				"address": "module.sample_opensearch_domain.aws_subnet.subnet_b",
				"module_address": "module.sample_opensearch_domain",
				"mode": "managed",
				"type": "aws_subnet",
				"name": "subnet_b",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"assign_ipv6_address_on_creation": false,
						"availability_zone": "us-west-2b",
						"cidr_block": "178.0.100.0/24",
						"customer_owned_ipv4_pool": null,
						"enable_dns64": false,
						"enable_resource_name_dns_a_record_on_launch": false,
						"enable_resource_name_dns_aaaa_record_on_launch": false,
						"ipv6_cidr_block": null,
						"ipv6_native": false,
						"map_customer_owned_ip_on_launch": null,
						"map_public_ip_on_launch": false,
						"outpost_arn": null,
						"tags": {"Name": "vpc-subnet-2b"},
						"tags_all": {"Name": "vpc-subnet-2b"},
						"timeouts": null,
					},
					"after_unknown": {
						"arn": true,
						"availability_zone_id": true,
						"id": true,
						"ipv6_cidr_block_association_id": true,
						"owner_id": true,
						"private_dns_hostname_type_on_launch": true,
						"tags": {},
						"tags_all": {},
						"vpc_id": true,
					},
					"before_sensitive": false,
					"after_sensitive": {
						"tags": {},
						"tags_all": {},
					},
				},
			},
			{
				"address": "module.sample_opensearch_domain.aws_vpc.app_vpc",
				"module_address": "module.sample_opensearch_domain",
				"mode": "managed",
				"type": "aws_vpc",
				"name": "app_vpc",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"assign_generated_ipv6_cidr_block": null,
						"cidr_block": "178.0.0.0/16",
						"enable_dns_support": true,
						"instance_tenancy": "default",
						"ipv4_ipam_pool_id": null,
						"ipv4_netmask_length": null,
						"ipv6_ipam_pool_id": null,
						"ipv6_netmask_length": null,
						"tags": {"Name": "app-vpc"},
						"tags_all": {"Name": "app-vpc"},
					},
					"after_unknown": {
						"arn": true,
						"default_network_acl_id": true,
						"default_route_table_id": true,
						"default_security_group_id": true,
						"dhcp_options_id": true,
						"enable_classiclink": true,
						"enable_classiclink_dns_support": true,
						"enable_dns_hostnames": true,
						"enable_network_address_usage_metrics": true,
						"id": true,
						"ipv6_association_id": true,
						"ipv6_cidr_block": true,
						"ipv6_cidr_block_network_border_group": true,
						"main_route_table_id": true,
						"owner_id": true,
						"tags": {},
						"tags_all": {},
					},
					"before_sensitive": false,
					"after_sensitive": {
						"tags": {},
						"tags_all": {},
					},
				},
			},
			{
				"address": "module.sample_opensearch_domain.data.aws_vpc.selected",
				"module_address": "module.sample_opensearch_domain",
				"mode": "data",
				"type": "aws_vpc",
				"name": "selected",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["read"],
					"before": null,
					"after": {"filter": []},
					"after_unknown": {
						"arn": true,
						"cidr_block": true,
						"cidr_block_associations": true,
						"default": true,
						"dhcp_options_id": true,
						"enable_dns_hostnames": true,
						"enable_dns_support": true,
						"enable_network_address_usage_metrics": true,
						"filter": [],
						"id": true,
						"instance_tenancy": true,
						"ipv6_association_id": true,
						"ipv6_cidr_block": true,
						"main_route_table_id": true,
						"owner_id": true,
						"state": true,
						"tags": true,
						"timeouts": true,
					},
					"before_sensitive": false,
					"after_sensitive": {
						"cidr_block_associations": [],
						"filter": [],
						"tags": {},
						"timeouts": {},
					},
				},
				"action_reason": "read_because_config_unknown",
			},
		],
		"prior_state": {
			"format_version": "1.0",
			"terraform_version": "1.2.7",
			"values": {"root_module": {"child_modules": [{
				"resources": [
					{
						"address": "module.sample_opensearch_domain.data.aws_caller_identity.current",
						"mode": "data",
						"type": "aws_caller_identity",
						"name": "current",
						"provider_name": "registry.terraform.io/hashicorp/aws",
						"schema_version": 0,
						"values": {
							"account_id": "449680582256",
							"arn": "arn:aws:sts::449680582256:assumed-role/AWSReservedSSO_AdministratorAccess_2b87b0e76046b497/amar.chand@styra.com",
							"id": "449680582256",
							"user_id": "AROAWRMYNEZYH2B7Y4TIY:amar.chand@styra.com",
						},
						"sensitive_values": {},
					},
					{
						"address": "module.sample_opensearch_domain.data.aws_region.current",
						"mode": "data",
						"type": "aws_region",
						"name": "current",
						"provider_name": "registry.terraform.io/hashicorp/aws",
						"schema_version": 0,
						"values": {
							"description": "US West (Oregon)",
							"endpoint": "ec2.us-west-2.amazonaws.com",
							"id": "us-west-2",
							"name": "us-west-2",
						},
						"sensitive_values": {},
					},
				],
				"address": "module.sample_opensearch_domain",
			}]}},
		},
		"configuration": {
			"provider_config": {"module.sample_opensearch_domain:aws": {
				"name": "aws",
				"full_name": "registry.terraform.io/hashicorp/aws",
				"version_constraint": "~> 4.0",
				"module_address": "module.sample_opensearch_domain",
				"expressions": {"region": {"references": ["var.region"]}},
			}},
			"root_module": {"module_calls": {"sample_opensearch_domain": {
				"source": "../../../../../modules/opensearch/os_domain_in_vpc",
				"module": {
					"resources": [
						{
							"address": "aws_iam_service_linked_role.es",
							"mode": "managed",
							"type": "aws_iam_service_linked_role",
							"name": "es",
							"provider_config_key": "module.sample_opensearch_domain:aws",
							"expressions": {"aws_service_name": {"constant_value": "opensearchservice.amazonaws.com"}},
							"schema_version": 0,
						},
						{
							"address": "aws_internet_gateway.igw",
							"mode": "managed",
							"type": "aws_internet_gateway",
							"name": "igw",
							"provider_config_key": "module.sample_opensearch_domain:aws",
							"expressions": {
								"tags": {"constant_value": {"Name": "vpc_igw"}},
								"vpc_id": {"references": [
									"aws_vpc.app_vpc.id",
									"aws_vpc.app_vpc",
								]},
							},
							"schema_version": 0,
						},
						{
							"address": "aws_opensearch_domain.example",
							"mode": "managed",
							"type": "aws_opensearch_domain",
							"name": "example",
							"provider_config_key": "module.sample_opensearch_domain:aws",
							"expressions": {
								"cluster_config": [{"instance_type": {"constant_value": "r4.large.search"}}],
								"domain_name": {"constant_value": "opensearch-domain"},
								"ebs_options": [{
									"ebs_enabled": {"constant_value": true},
									"volume_size": {"constant_value": 10},
								}],
								"encrypt_at_rest": [{"enabled": {"constant_value": true}}],
								"node_to_node_encryption": [{"enabled": {"constant_value": true}}],
								"tags": {"constant_value": {"Domain": "TestDomain"}},
								"vpc_options": [{
									"security_group_ids": {"references": [
										"aws_security_group.os.id",
										"aws_security_group.os",
									]},
									"subnet_ids": {"references": [
										"aws_subnet.subnet_a.id",
										"aws_subnet.subnet_a",
										"aws_subnet.subnet_b.id",
										"aws_subnet.subnet_b",
									]},
								}],
							},
							"schema_version": 0,
						},
						{
							"address": "aws_route_table.vpc_rt",
							"mode": "managed",
							"type": "aws_route_table",
							"name": "vpc_rt",
							"provider_config_key": "module.sample_opensearch_domain:aws",
							"expressions": {
								"route": {"references": [
									"aws_internet_gateway.igw.id",
									"aws_internet_gateway.igw",
								]},
								"tags": {"constant_value": {"Name": "vpc_rt"}},
								"vpc_id": {"references": [
									"aws_vpc.app_vpc.id",
									"aws_vpc.app_vpc",
								]},
							},
							"schema_version": 0,
						},
						{
							"address": "aws_security_group.os",
							"mode": "managed",
							"type": "aws_security_group",
							"name": "os",
							"provider_config_key": "module.sample_opensearch_domain:aws",
							"expressions": {
								"description": {"constant_value": "Managed by Terraform"},
								"ingress": {"references": [
									"data.aws_vpc.selected.cidr_block",
									"data.aws_vpc.selected",
								]},
								"name": {"references": [
									"aws_vpc.app_vpc.id",
									"aws_vpc.app_vpc",
									"var.domain",
								]},
								"vpc_id": {"references": [
									"data.aws_vpc.selected.id",
									"data.aws_vpc.selected",
								]},
							},
							"schema_version": 1,
						},
						{
							"address": "aws_subnet.subnet_a",
							"mode": "managed",
							"type": "aws_subnet",
							"name": "subnet_a",
							"provider_config_key": "module.sample_opensearch_domain:aws",
							"expressions": {
								"availability_zone": {"constant_value": "us-west-2a"},
								"cidr_block": {"references": ["var.subnet_a_cidr"]},
								"tags": {"constant_value": {"Name": "vpc-subnet-2a"}},
								"vpc_id": {"references": [
									"aws_vpc.app_vpc.id",
									"aws_vpc.app_vpc",
								]},
							},
							"schema_version": 1,
						},
						{
							"address": "aws_subnet.subnet_b",
							"mode": "managed",
							"type": "aws_subnet",
							"name": "subnet_b",
							"provider_config_key": "module.sample_opensearch_domain:aws",
							"expressions": {
								"availability_zone": {"constant_value": "us-west-2b"},
								"cidr_block": {"references": ["var.subnet_b_cidr"]},
								"tags": {"constant_value": {"Name": "vpc-subnet-2b"}},
								"vpc_id": {"references": [
									"aws_vpc.app_vpc.id",
									"aws_vpc.app_vpc",
								]},
							},
							"schema_version": 1,
						},
						{
							"address": "aws_vpc.app_vpc",
							"mode": "managed",
							"type": "aws_vpc",
							"name": "app_vpc",
							"provider_config_key": "module.sample_opensearch_domain:aws",
							"expressions": {
								"cidr_block": {"references": ["var.vpc_cidr"]},
								"tags": {"constant_value": {"Name": "app-vpc"}},
							},
							"schema_version": 1,
						},
						{
							"address": "data.aws_caller_identity.current",
							"mode": "data",
							"type": "aws_caller_identity",
							"name": "current",
							"provider_config_key": "module.sample_opensearch_domain:aws",
							"schema_version": 0,
						},
						{
							"address": "data.aws_region.current",
							"mode": "data",
							"type": "aws_region",
							"name": "current",
							"provider_config_key": "module.sample_opensearch_domain:aws",
							"schema_version": 0,
						},
						{
							"address": "data.aws_vpc.selected",
							"mode": "data",
							"type": "aws_vpc",
							"name": "selected",
							"provider_config_key": "module.sample_opensearch_domain:aws",
							"expressions": {"id": {"references": [
								"aws_vpc.app_vpc.id",
								"aws_vpc.app_vpc",
							]}},
							"schema_version": 0,
						},
					],
					"variables": {
						"domain": {"default": "tf-test"},
						"region": {"default": "us-west-2"},
						"subnet_a_cidr": {"default": "178.0.10.0/24"},
						"subnet_b_cidr": {"default": "178.0.100.0/24"},
						"vpc_cidr": {"default": "178.0.0.0/16"},
					},
				},
			}}},
		},
		"relevant_attributes": [
			{
				"resource": "module.sample_opensearch_domain.aws_vpc.app_vpc",
				"attribute": ["id"],
			},
			{
				"resource": "module.sample_opensearch_domain.data.aws_vpc.selected",
				"attribute": ["id"],
			},
			{
				"resource": "module.sample_opensearch_domain.data.aws_vpc.selected",
				"attribute": ["cidr_block"],
			},
			{
				"resource": "module.sample_opensearch_domain.aws_internet_gateway.igw",
				"attribute": ["id"],
			},
			{
				"resource": "module.sample_opensearch_domain.aws_security_group.os",
				"attribute": ["id"],
			},
			{
				"resource": "module.sample_opensearch_domain.aws_subnet.subnet_a",
				"attribute": ["id"],
			},
			{
				"resource": "module.sample_opensearch_domain.aws_subnet.subnet_b",
				"attribute": ["id"],
			},
		],
	}
}

input_opensearch_domain_without_vpc_options_block = {
	"format_version": "1.1",
	"terraform_version": "1.2.7",
	"planned_values": {"root_module": {"child_modules": [{
		"resources": [{
			"address": "module.sample_opensearch_domain.aws_opensearch_domain.example",
			"mode": "managed",
			"type": "aws_opensearch_domain",
			"name": "example",
			"provider_name": "registry.terraform.io/hashicorp/aws",
			"schema_version": 0,
			"values": {
				"cluster_config": [{
					"dedicated_master_count": null,
					"dedicated_master_enabled": false,
					"dedicated_master_type": null,
					"instance_count": 1,
					"instance_type": "r4.large.search",
					"warm_count": null,
					"warm_enabled": null,
					"warm_type": null,
					"zone_awareness_config": [],
					"zone_awareness_enabled": null,
				}],
				"cognito_options": [],
				"domain_name": "opensearch-domain",
				"ebs_options": [{
					"ebs_enabled": true,
					"volume_size": 10,
				}],
				"encrypt_at_rest": [{"enabled": true}],
				"engine_version": "OpenSearch_1.1",
				"log_publishing_options": [],
				"snapshot_options": [],
				"tags": {"Domain": "TestDomain"},
				"tags_all": {"Domain": "TestDomain"},
				"timeouts": null,
			},
			"sensitive_values": {
				"advanced_options": {},
				"advanced_security_options": [],
				"auto_tune_options": [],
				"cluster_config": [{
					"cold_storage_options": [],
					"zone_awareness_config": [],
				}],
				"cognito_options": [],
				"domain_endpoint_options": [],
				"ebs_options": [{}],
				"encrypt_at_rest": [{}],
				"log_publishing_options": [],
				"node_to_node_encryption": [],
				"snapshot_options": [],
				"tags": {},
				"tags_all": {},
				"vpc_options": [],
			},
		}],
		"address": "module.sample_opensearch_domain",
	}]}},
	"resource_changes": [{
		"address": "module.sample_opensearch_domain.aws_opensearch_domain.example",
		"module_address": "module.sample_opensearch_domain",
		"mode": "managed",
		"type": "aws_opensearch_domain",
		"name": "example",
		"provider_name": "registry.terraform.io/hashicorp/aws",
		"change": {
			"actions": ["create"],
			"before": null,
			"after": {
				"cluster_config": [{
					"dedicated_master_count": null,
					"dedicated_master_enabled": false,
					"dedicated_master_type": null,
					"instance_count": 1,
					"instance_type": "r4.large.search",
					"warm_count": null,
					"warm_enabled": null,
					"warm_type": null,
					"zone_awareness_config": [],
					"zone_awareness_enabled": null,
				}],
				"cognito_options": [],
				"domain_name": "opensearch-domain",
				"ebs_options": [{
					"ebs_enabled": true,
					"volume_size": 10,
				}],
				"encrypt_at_rest": [{"enabled": true}],
				"engine_version": "OpenSearch_1.1",
				"log_publishing_options": [],
				"snapshot_options": [],
				"tags": {"Domain": "TestDomain"},
				"tags_all": {"Domain": "TestDomain"},
				"timeouts": null,
				"vpc_options": [],
			},
			"after_unknown": {
				"access_policies": true,
				"advanced_options": true,
				"advanced_security_options": true,
				"arn": true,
				"auto_tune_options": true,
				"cluster_config": [{
					"cold_storage_options": true,
					"zone_awareness_config": [],
				}],
				"cognito_options": [],
				"domain_endpoint_options": true,
				"domain_id": true,
				"ebs_options": [{
					"iops": true,
					"throughput": true,
					"volume_type": true,
				}],
				"encrypt_at_rest": [{"kms_key_id": true}],
				"endpoint": true,
				"id": true,
				"kibana_endpoint": true,
				"log_publishing_options": [],
				"node_to_node_encryption": true,
				"snapshot_options": [],
				"tags": {},
				"tags_all": {},
			},
			"before_sensitive": false,
			"after_sensitive": {
				"advanced_options": {},
				"advanced_security_options": [],
				"auto_tune_options": [],
				"cluster_config": [{
					"cold_storage_options": [],
					"zone_awareness_config": [],
				}],
				"cognito_options": [],
				"domain_endpoint_options": [],
				"ebs_options": [{}],
				"encrypt_at_rest": [{}],
				"log_publishing_options": [],
				"node_to_node_encryption": [],
				"snapshot_options": [],
				"tags": {},
				"tags_all": {},
				"vpc_options": [],
			},
		},
	}],
	"configuration": {
		"provider_config": {"module.sample_opensearch_domain:aws": {
			"name": "aws",
			"full_name": "registry.terraform.io/hashicorp/aws",
			"version_constraint": "~> 4.0",
			"module_address": "module.sample_opensearch_domain",
			"expressions": {"region": {"references": ["var.region"]}},
		}},
		"root_module": {"module_calls": {"sample_opensearch_domain": {
			"source": "../../../../../modules/opensearch",
			"module": {
				"resources": [{
					"address": "aws_opensearch_domain.example",
					"mode": "managed",
					"type": "aws_opensearch_domain",
					"name": "example",
					"provider_config_key": "module.sample_opensearch_domain:aws",
					"expressions": {
						"cluster_config": [{"instance_type": {"constant_value": "r4.large.search"}}],
						"domain_name": {"constant_value": "opensearch-domain"},
						"ebs_options": [{
							"ebs_enabled": {"constant_value": true},
							"volume_size": {"constant_value": 10},
						}],
						"encrypt_at_rest": [{"enabled": {"constant_value": true}}],
						"tags": {"constant_value": {"Domain": "TestDomain"}},
					},
					"schema_version": 0,
				}],
				"variables": {"region": {"default": "us-west-2"}},
			},
		}}},
	},
}
