package global.systemtypes["terraform:2.0"].library.provider.aws.cloudfront.restrict_viewer_protocol_policy_allow_all.test_v1

import data.global.systemtypes["terraform:2.0"].library.provider.aws.cloudfront.restrict_viewer_protocol_policy_allow_all.v1

test_default_cache_behavior_viewer_protocol_policy_allow_all_good {
	default_cache_behavior_viewer_protocol_policy := "https"
	in := input_cloudfront_distribution_without_ordered_cache_behavior(default_cache_behavior_viewer_protocol_policy)
	actual := v1.prohibit_cloudfront_distribution_without_retricted_viewer_protocol_policy with input as in
	count(actual) == 0
}

test_ordered_cache_behavior_viewer_protocol_policy_allow_all_good {
	default_cache_behavior_viewer_protocol_policy := "https"
	ordered_cache_behavior_viewer_protocol_policy := "redirect-to-https"
	in := input_cloudfront_distribution_with_ordered_cache_behavior(default_cache_behavior_viewer_protocol_policy, ordered_cache_behavior_viewer_protocol_policy)
	actual := v1.prohibit_cloudfront_distribution_without_retricted_viewer_protocol_policy with input as in
	count(actual) == 0
}

test_multiple_ordered_cache_behavior_viewer_protocol_policy_allow_all_good {
	default_cache_behavior_viewer_protocol_policy := "https"
	ordered_cache_behavior_viewer_protocol_policy_1 := "https"
	ordered_cache_behavior_viewer_protocol_policy_2 := "redirect-to-https"
	in := input_cloudfront_distribution_with_multiple_ordered_cache_behavior(default_cache_behavior_viewer_protocol_policy, ordered_cache_behavior_viewer_protocol_policy_1, ordered_cache_behavior_viewer_protocol_policy_2)
	actual := v1.prohibit_cloudfront_distribution_without_retricted_viewer_protocol_policy with input as in
	count(actual) == 0
}

test_default_cache_behavior_viewer_protocol_policy_allow_all_bad {
	default_cache_behavior_viewer_protocol_policy := "allow-all"
	in := input_cloudfront_distribution_without_ordered_cache_behavior(default_cache_behavior_viewer_protocol_policy)
	actual := v1.prohibit_cloudfront_distribution_without_retricted_viewer_protocol_policy with input as in
	count(actual) == 1
}

test_ordered_cache_behavior_viewer_protocol_policy_allow_all_1_bad {
	default_cache_behavior_viewer_protocol_policy := "https"
	ordered_cache_behavior_viewer_protocol_policy := "allow-all"
	in := input_cloudfront_distribution_with_ordered_cache_behavior(default_cache_behavior_viewer_protocol_policy, ordered_cache_behavior_viewer_protocol_policy)
	actual := v1.prohibit_cloudfront_distribution_without_retricted_viewer_protocol_policy with input as in
	count(actual) == 1
}

test_multiple_ordered_cache_behavior_viewer_protocol_policy_allow_all_1_bad {
	default_cache_behavior_viewer_protocol_policy := "https"
	ordered_cache_behavior_viewer_protocol_policy_1 := "allow-all"
	ordered_cache_behavior_viewer_protocol_policy_2 := "allow-all"
	in := input_cloudfront_distribution_with_multiple_ordered_cache_behavior(default_cache_behavior_viewer_protocol_policy, ordered_cache_behavior_viewer_protocol_policy_1, ordered_cache_behavior_viewer_protocol_policy_2)
	actual := v1.prohibit_cloudfront_distribution_without_retricted_viewer_protocol_policy with input as in
	count(actual) == 1
}

test_multiple_ordered_cache_behavior_viewer_protocol_policy_allow_all_2_bad {
	default_cache_behavior_viewer_protocol_policy := "allow-all"
	ordered_cache_behavior_viewer_protocol_policy_1 := "allow-all"
	ordered_cache_behavior_viewer_protocol_policy_2 := "allow-all"
	in := input_cloudfront_distribution_with_multiple_ordered_cache_behavior(default_cache_behavior_viewer_protocol_policy, ordered_cache_behavior_viewer_protocol_policy_1, ordered_cache_behavior_viewer_protocol_policy_2)
	actual := v1.prohibit_cloudfront_distribution_without_retricted_viewer_protocol_policy with input as in
	count(actual) == 2
}

input_cloudfront_distribution_without_ordered_cache_behavior(default_cache_behavior_viewer_protocol_policy) := x {
	x := {
		"configuration": {
			"provider_config": {"aws": {
				"expressions": {
					"profile": {"constant_value": "default"},
					"region": {"references": ["var.region"]},
				},
				"name": "aws",
				"version_constraint": "~> 3.27",
			}},
			"root_module": {
				"resources": [
					{
						"address": "aws_cloudfront_distribution.s3_distribution",
						"expressions": {
							"default_cache_behavior": [{
								"allowed_methods": {"constant_value": [
									"DELETE",
									"GET",
									"HEAD",
									"OPTIONS",
									"PATCH",
									"POST",
									"PUT",
								]},
								"cached_methods": {"constant_value": [
									"GET",
									"HEAD",
								]},
								"default_ttl": {"constant_value": 3600},
								"forwarded_values": [{
									"cookies": [{"forward": {"constant_value": "none"}}],
									"query_string": {"constant_value": false},
								}],
								"max_ttl": {"constant_value": 86400},
								"min_ttl": {"constant_value": 0},
								"target_origin_id": {"references": ["local.s3_origin_id"]},
								"viewer_protocol_policy": {"constant_value": "allow-all"},
							}],
							"enabled": {"constant_value": true},
							"origin": [{
								"domain_name": {"references": [
									"aws_s3_bucket.tf_sample_s3.bucket_regional_domain_name",
									"aws_s3_bucket.tf_sample_s3",
								]},
								"origin_id": {"references": ["local.s3_origin_id"]},
								"s3_origin_config": [{"origin_access_identity": {"references": [
									"aws_cloudfront_origin_access_identity.cdn_origin_access_identity.cloudfront_access_identity_path",
									"aws_cloudfront_origin_access_identity.cdn_origin_access_identity",
								]}}],
							}],
							"price_class": {"constant_value": "PriceClass_200"},
							"restrictions": [{"geo_restriction": [{
								"locations": {"constant_value": [
									"US",
									"CA",
									"GB",
									"DE",
								]},
								"restriction_type": {"constant_value": "whitelist"},
							}]}],
							"tags": {"constant_value": {"Environment": "dev"}},
							"viewer_certificate": [{"cloudfront_default_certificate": {"constant_value": true}}],
						},
						"mode": "managed",
						"name": "s3_distribution",
						"provider_config_key": "aws",
						"schema_version": 1,
						"type": "aws_cloudfront_distribution",
					},
					{
						"address": "aws_cloudfront_origin_access_identity.cdn_origin_access_identity",
						"expressions": {"comment": {"constant_value": "aws_cloudfront_origin_access_identity"}},
						"mode": "managed",
						"name": "cdn_origin_access_identity",
						"provider_config_key": "aws",
						"schema_version": 0,
						"type": "aws_cloudfront_origin_access_identity",
					},
					{
						"address": "aws_route53_zone.tf_sample_r53",
						"expressions": {
							"name": {"constant_value": "tfsampler53.com"},
							"vpc": [{"vpc_id": {"references": [
								"aws_vpc.tf_sample_vpc.id",
								"aws_vpc.tf_sample_vpc",
							]}}],
						},
						"mode": "managed",
						"name": "tf_sample_r53",
						"provider_config_key": "aws",
						"schema_version": 0,
						"type": "aws_route53_zone",
					},
					{
						"address": "aws_s3_bucket.tf_sample_s3",
						"expressions": {
							"bucket": {"references": ["local.bucket_name"]},
							"hosted_zone_id": {"references": [
								"aws_route53_zone.tf_sample_r53.id",
								"aws_route53_zone.tf_sample_r53",
							]},
							"tags": {"constant_value": {
								"Name": "My bucket",
								"Purpose": "Policy Library Development",
							}},
						},
						"mode": "managed",
						"name": "tf_sample_s3",
						"provider_config_key": "aws",
						"schema_version": 0,
						"type": "aws_s3_bucket",
					},
					{
						"address": "aws_vpc.tf_sample_vpc",
						"expressions": {
							"cidr_block": {"references": ["var.vpc_cidr"]},
							"tags": {"constant_value": {"Name": "tf_sample_vpc"}},
						},
						"mode": "managed",
						"name": "tf_sample_vpc",
						"provider_config_key": "aws",
						"schema_version": 1,
						"type": "aws_vpc",
					},
					{
						"address": "random_string.random_val",
						"expressions": {
							"length": {"constant_value": 4},
							"override_special": {"constant_value": ".-"},
							"special": {"constant_value": true},
							"upper": {"constant_value": false},
						},
						"mode": "managed",
						"name": "random_val",
						"provider_config_key": "random",
						"schema_version": 1,
						"type": "random_string",
					},
				],
				"variables": {
					"region": {"default": "us-west-2"},
					"vpc_cidr": {"default": "178.0.0.0/16"},
				},
			},
		},
		"format_version": "1.0",
		"planned_values": {"root_module": {"resources": [
			{
				"address": "aws_cloudfront_distribution.s3_distribution",
				"mode": "managed",
				"name": "s3_distribution",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 1,
				"sensitive_values": {
					"custom_error_response": [],
					"default_cache_behavior": [{
						"allowed_methods": [
							false,
							false,
							false,
							false,
							false,
							false,
							false,
						],
						"cached_methods": [
							false,
							false,
						],
						"forwarded_values": [{
							"cookies": [{"whitelisted_names": []}],
							"headers": [],
							"query_string_cache_keys": [],
						}],
						"function_association": [],
						"lambda_function_association": [],
						"trusted_key_groups": [],
						"trusted_signers": [],
					}],
					"logging_config": [],
					"ordered_cache_behavior": [],
					"origin": [{
						"custom_header": [],
						"custom_origin_config": [],
						"origin_shield": [],
						"s3_origin_config": [{}],
					}],
					"origin_group": [],
					"restrictions": [{"geo_restriction": [{"locations": [
						false,
						false,
						false,
						false,
					]}]}],
					"tags": {},
					"tags_all": {},
					"trusted_key_groups": [],
					"trusted_signers": [],
					"viewer_certificate": [{}],
				},
				"type": "aws_cloudfront_distribution",
				"values": {
					"aliases": null,
					"comment": null,
					"custom_error_response": [],
					"default_cache_behavior": [{
						"allowed_methods": [
							"DELETE",
							"GET",
							"HEAD",
							"OPTIONS",
							"PATCH",
							"POST",
							"PUT",
						],
						"cache_policy_id": null,
						"cached_methods": [
							"GET",
							"HEAD",
						],
						"compress": false,
						"default_ttl": 3600,
						"field_level_encryption_id": null,
						"forwarded_values": [{
							"cookies": [{"forward": "none"}],
							"query_string": false,
						}],
						"function_association": [],
						"lambda_function_association": [],
						"max_ttl": 86400,
						"min_ttl": 0,
						"origin_request_policy_id": null,
						"realtime_log_config_arn": null,
						"response_headers_policy_id": null,
						"smooth_streaming": null,
						"target_origin_id": "myS3Origin",
						"viewer_protocol_policy": default_cache_behavior_viewer_protocol_policy,
					}],
					"default_root_object": null,
					"enabled": true,
					"http_version": "http2",
					"is_ipv6_enabled": false,
					"logging_config": [],
					"ordered_cache_behavior": [],
					"origin": [{
						"connection_attempts": 3,
						"connection_timeout": 10,
						"custom_header": [],
						"custom_origin_config": [],
						"origin_id": "myS3Origin",
						"origin_path": "",
						"origin_shield": [],
						"s3_origin_config": [{"origin_access_identity": "origin-access-identity/cloudfront/E2YSUZQQDNB6RH"}],
					}],
					"origin_group": [],
					"price_class": "PriceClass_200",
					"restrictions": [{"geo_restriction": [{
						"locations": [
							"CA",
							"DE",
							"GB",
							"US",
						],
						"restriction_type": "whitelist",
					}]}],
					"retain_on_delete": false,
					"tags": {"Environment": "dev"},
					"tags_all": {"Environment": "dev"},
					"viewer_certificate": [{
						"acm_certificate_arn": null,
						"cloudfront_default_certificate": true,
						"iam_certificate_id": null,
						"minimum_protocol_version": "TLSv1",
						"ssl_support_method": null,
					}],
					"wait_for_deployment": true,
					"web_acl_id": null,
				},
			},
			{
				"address": "aws_cloudfront_origin_access_identity.cdn_origin_access_identity",
				"mode": "managed",
				"name": "cdn_origin_access_identity",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 0,
				"sensitive_values": {},
				"type": "aws_cloudfront_origin_access_identity",
				"values": {
					"caller_reference": "terraform-20220511153148616300000001",
					"cloudfront_access_identity_path": "origin-access-identity/cloudfront/E2YSUZQQDNB6RH",
					"comment": "aws_cloudfront_origin_access_identity",
					"etag": "EEXMP1KUAB8HZ",
					"iam_arn": "arn:aws:iam::cloudfront:user/CloudFront Origin Access Identity E2YSUZQQDNB6RH",
					"id": "E2YSUZQQDNB6RH",
					"s3_canonical_user_id": "df80295e0bb754c942b15d5487a498e18201e7bf5bdfcf41892361df60e933cf885a1f145ab62996f704268d5f8a8b51",
				},
			},
			{
				"address": "aws_route53_zone.tf_sample_r53",
				"mode": "managed",
				"name": "tf_sample_r53",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 0,
				"sensitive_values": {
					"name_servers": [],
					"tags_all": {},
					"vpc": [{}],
				},
				"type": "aws_route53_zone",
				"values": {
					"comment": "Managed by Terraform",
					"delegation_set_id": null,
					"force_destroy": false,
					"name": "tfsampler53.com",
					"tags": null,
					"vpc": [{"vpc_id": "vpc-0349411d5238970be"}],
				},
			},
			{
				"address": "aws_s3_bucket.tf_sample_s3",
				"mode": "managed",
				"name": "tf_sample_s3",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 0,
				"sensitive_values": {
					"cors_rule": [],
					"grant": [],
					"lifecycle_rule": [],
					"logging": [],
					"object_lock_configuration": [],
					"replication_configuration": [],
					"server_side_encryption_configuration": [],
					"tags": {},
					"tags_all": {},
					"versioning": [],
					"website": [],
				},
				"type": "aws_s3_bucket",
				"values": {
					"acl": "private",
					"bucket_prefix": null,
					"cors_rule": [],
					"force_destroy": false,
					"grant": [],
					"lifecycle_rule": [],
					"logging": [],
					"policy": null,
					"replication_configuration": [],
					"server_side_encryption_configuration": [],
					"tags": {
						"Name": "My bucket",
						"Purpose": "Policy Library Development",
					},
					"tags_all": {
						"Name": "My bucket",
						"Purpose": "Policy Library Development",
					},
					"website": [],
				},
			},
			{
				"address": "aws_vpc.tf_sample_vpc",
				"mode": "managed",
				"name": "tf_sample_vpc",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 1,
				"sensitive_values": {
					"tags": {},
					"tags_all": {},
				},
				"type": "aws_vpc",
				"values": {
					"arn": "arn:aws:ec2:us-west-2:880619295091:vpc/vpc-0349411d5238970be",
					"assign_generated_ipv6_cidr_block": false,
					"cidr_block": "178.0.0.0/16",
					"default_network_acl_id": "acl-07a43d3efc0dbe154",
					"default_route_table_id": "rtb-06f16b2d5f4617c60",
					"default_security_group_id": "sg-065f371d5b8048334",
					"dhcp_options_id": "dopt-045bf5d92076494e2",
					"enable_classiclink": false,
					"enable_classiclink_dns_support": false,
					"enable_dns_hostnames": false,
					"enable_dns_support": true,
					"id": "vpc-0349411d5238970be",
					"instance_tenancy": "default",
					"ipv4_ipam_pool_id": null,
					"ipv4_netmask_length": null,
					"ipv6_association_id": "",
					"ipv6_cidr_block": "",
					"ipv6_cidr_block_network_border_group": "",
					"ipv6_ipam_pool_id": "",
					"ipv6_netmask_length": 0,
					"main_route_table_id": "rtb-06f16b2d5f4617c60",
					"owner_id": "880619295091",
					"tags": {"Name": "tf_sample_vpc"},
					"tags_all": {"Name": "tf_sample_vpc"},
				},
			},
			{
				"address": "random_string.random_val",
				"mode": "managed",
				"name": "random_val",
				"provider_name": "registry.terraform.io/hashicorp/random",
				"schema_version": 1,
				"sensitive_values": {},
				"type": "random_string",
				"values": {
					"keepers": null,
					"length": 4,
					"lower": true,
					"min_lower": 0,
					"min_numeric": 0,
					"min_special": 0,
					"min_upper": 0,
					"number": true,
					"override_special": ".-",
					"special": true,
					"upper": false,
				},
			},
		]}},
		"prior_state": {
			"format_version": "1.0",
			"terraform_version": "1.1.9",
			"values": {"root_module": {"resources": [
				{
					"address": "aws_cloudfront_origin_access_identity.cdn_origin_access_identity",
					"mode": "managed",
					"name": "cdn_origin_access_identity",
					"provider_name": "registry.terraform.io/hashicorp/aws",
					"schema_version": 0,
					"sensitive_values": {},
					"type": "aws_cloudfront_origin_access_identity",
					"values": {
						"caller_reference": "terraform-20220511153148616300000001",
						"cloudfront_access_identity_path": "origin-access-identity/cloudfront/E2YSUZQQDNB6RH",
						"comment": "aws_cloudfront_origin_access_identity",
						"etag": "EEXMP1KUAB8HZ",
						"iam_arn": "arn:aws:iam::cloudfront:user/CloudFront Origin Access Identity E2YSUZQQDNB6RH",
						"id": "E2YSUZQQDNB6RH",
						"s3_canonical_user_id": "df80295e0bb754c942b15d5487a498e18201e7bf5bdfcf41892361df60e933cf885a1f145ab62996f704268d5f8a8b51",
					},
				},
				{
					"address": "aws_route53_zone.tf_sample_r53",
					"depends_on": ["aws_vpc.tf_sample_vpc"],
					"mode": "managed",
					"name": "tf_sample_r53",
					"provider_name": "registry.terraform.io/hashicorp/aws",
					"schema_version": 0,
					"sensitive_values": {
						"name_servers": [
							false,
							false,
							false,
							false,
						],
						"tags": {},
						"tags_all": {},
						"vpc": [{}],
					},
					"type": "aws_route53_zone",
					"values": {
						"arn": "arn:aws:route53:::hostedzone/Z0721299JY9JOBQ6KW4O",
						"comment": "Managed by Terraform",
						"delegation_set_id": "",
						"force_destroy": false,
						"id": "Z0721299JY9JOBQ6KW4O",
						"name": "gswebapp.com",
						"name_servers": [
							"ns-0.awsdns-00.com.",
							"ns-1024.awsdns-00.org.",
							"ns-1536.awsdns-00.co.uk.",
							"ns-512.awsdns-00.net.",
						],
						"tags": {},
						"tags_all": {},
						"vpc": [{
							"vpc_id": "vpc-0349411d5238970be",
							"vpc_region": "us-west-2",
						}],
						"zone_id": "Z0721299JY9JOBQ6KW4O",
					},
				},
				{
					"address": "aws_vpc.tf_sample_vpc",
					"mode": "managed",
					"name": "tf_sample_vpc",
					"provider_name": "registry.terraform.io/hashicorp/aws",
					"schema_version": 1,
					"sensitive_values": {
						"tags": {},
						"tags_all": {},
					},
					"type": "aws_vpc",
					"values": {
						"arn": "arn:aws:ec2:us-west-2:880619295091:vpc/vpc-0349411d5238970be",
						"assign_generated_ipv6_cidr_block": false,
						"cidr_block": "178.0.0.0/16",
						"default_network_acl_id": "acl-07a43d3efc0dbe154",
						"default_route_table_id": "rtb-06f16b2d5f4617c60",
						"default_security_group_id": "sg-065f371d5b8048334",
						"dhcp_options_id": "dopt-045bf5d92076494e2",
						"enable_classiclink": false,
						"enable_classiclink_dns_support": false,
						"enable_dns_hostnames": false,
						"enable_dns_support": true,
						"id": "vpc-0349411d5238970be",
						"instance_tenancy": "default",
						"ipv4_ipam_pool_id": null,
						"ipv4_netmask_length": null,
						"ipv6_association_id": "",
						"ipv6_cidr_block": "",
						"ipv6_cidr_block_network_border_group": "",
						"ipv6_ipam_pool_id": "",
						"ipv6_netmask_length": 0,
						"main_route_table_id": "rtb-06f16b2d5f4617c60",
						"owner_id": "880619295091",
						"tags": {"Name": "tf_sample_vpc"},
						"tags_all": {"Name": "tf_sample_vpc"},
					},
				},
			]}},
		},
		"resource_changes": [
			{
				"address": "aws_cloudfront_distribution.s3_distribution",
				"change": {
					"actions": ["create"],
					"after": {
						"aliases": null,
						"comment": null,
						"custom_error_response": [],
						"default_cache_behavior": [{
							"allowed_methods": [
								"DELETE",
								"GET",
								"HEAD",
								"OPTIONS",
								"PATCH",
								"POST",
								"PUT",
							],
							"cache_policy_id": null,
							"cached_methods": [
								"GET",
								"HEAD",
							],
							"compress": false,
							"default_ttl": 3600,
							"field_level_encryption_id": null,
							"forwarded_values": [{
								"cookies": [{"forward": "none"}],
								"query_string": false,
							}],
							"function_association": [],
							"lambda_function_association": [],
							"max_ttl": 86400,
							"min_ttl": 0,
							"origin_request_policy_id": null,
							"realtime_log_config_arn": null,
							"response_headers_policy_id": null,
							"smooth_streaming": null,
							"target_origin_id": "myS3Origin",
							"viewer_protocol_policy": default_cache_behavior_viewer_protocol_policy,
						}],
						"default_root_object": null,
						"enabled": true,
						"http_version": "http2",
						"is_ipv6_enabled": false,
						"logging_config": [],
						"ordered_cache_behavior": [],
						"origin": [{
							"connection_attempts": 3,
							"connection_timeout": 10,
							"custom_header": [],
							"custom_origin_config": [],
							"origin_id": "myS3Origin",
							"origin_path": "",
							"origin_shield": [],
							"s3_origin_config": [{"origin_access_identity": "origin-access-identity/cloudfront/E2YSUZQQDNB6RH"}],
						}],
						"origin_group": [],
						"price_class": "PriceClass_200",
						"restrictions": [{"geo_restriction": [{
							"locations": [
								"CA",
								"DE",
								"GB",
								"US",
							],
							"restriction_type": "whitelist",
						}]}],
						"retain_on_delete": false,
						"tags": {"Environment": "dev"},
						"tags_all": {"Environment": "dev"},
						"viewer_certificate": [{
							"acm_certificate_arn": null,
							"cloudfront_default_certificate": true,
							"iam_certificate_id": null,
							"minimum_protocol_version": "TLSv1",
							"ssl_support_method": null,
						}],
						"wait_for_deployment": true,
						"web_acl_id": null,
					},
					"after_sensitive": {
						"custom_error_response": [],
						"default_cache_behavior": [{
							"allowed_methods": [
								false,
								false,
								false,
								false,
								false,
								false,
								false,
							],
							"cached_methods": [
								false,
								false,
							],
							"forwarded_values": [{
								"cookies": [{"whitelisted_names": []}],
								"headers": [],
								"query_string_cache_keys": [],
							}],
							"function_association": [],
							"lambda_function_association": [],
							"trusted_key_groups": [],
							"trusted_signers": [],
						}],
						"logging_config": [],
						"ordered_cache_behavior": [],
						"origin": [{
							"custom_header": [],
							"custom_origin_config": [],
							"origin_shield": [],
							"s3_origin_config": [{}],
						}],
						"origin_group": [],
						"restrictions": [{"geo_restriction": [{"locations": [
							false,
							false,
							false,
							false,
						]}]}],
						"tags": {},
						"tags_all": {},
						"trusted_key_groups": [],
						"trusted_signers": [],
						"viewer_certificate": [{}],
					},
					"after_unknown": {
						"arn": true,
						"caller_reference": true,
						"custom_error_response": [],
						"default_cache_behavior": [{
							"allowed_methods": [
								false,
								false,
								false,
								false,
								false,
								false,
								false,
							],
							"cached_methods": [
								false,
								false,
							],
							"forwarded_values": [{
								"cookies": [{"whitelisted_names": true}],
								"headers": true,
								"query_string_cache_keys": true,
							}],
							"function_association": [],
							"lambda_function_association": [],
							"trusted_key_groups": true,
							"trusted_signers": true,
						}],
						"domain_name": true,
						"etag": true,
						"hosted_zone_id": true,
						"id": true,
						"in_progress_validation_batches": true,
						"last_modified_time": true,
						"logging_config": [],
						"ordered_cache_behavior": [],
						"origin": [{
							"custom_header": [],
							"custom_origin_config": [],
							"domain_name": true,
							"origin_shield": [],
							"s3_origin_config": [{}],
						}],
						"origin_group": [],
						"restrictions": [{"geo_restriction": [{"locations": [
							false,
							false,
							false,
							false,
						]}]}],
						"status": true,
						"tags": {},
						"tags_all": {},
						"trusted_key_groups": true,
						"trusted_signers": true,
						"viewer_certificate": [{}],
					},
					"before": null,
					"before_sensitive": false,
				},
				"mode": "managed",
				"name": "s3_distribution",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"type": "aws_cloudfront_distribution",
			},
			{
				"address": "aws_cloudfront_origin_access_identity.cdn_origin_access_identity",
				"change": {
					"actions": ["no-op"],
					"after": {
						"caller_reference": "terraform-20220511153148616300000001",
						"cloudfront_access_identity_path": "origin-access-identity/cloudfront/E2YSUZQQDNB6RH",
						"comment": "aws_cloudfront_origin_access_identity",
						"etag": "EEXMP1KUAB8HZ",
						"iam_arn": "arn:aws:iam::cloudfront:user/CloudFront Origin Access Identity E2YSUZQQDNB6RH",
						"id": "E2YSUZQQDNB6RH",
						"s3_canonical_user_id": "df80295e0bb754c942b15d5487a498e18201e7bf5bdfcf41892361df60e933cf885a1f145ab62996f704268d5f8a8b51",
					},
					"after_sensitive": {},
					"after_unknown": {},
					"before": {
						"caller_reference": "terraform-20220511153148616300000001",
						"cloudfront_access_identity_path": "origin-access-identity/cloudfront/E2YSUZQQDNB6RH",
						"comment": "aws_cloudfront_origin_access_identity",
						"etag": "EEXMP1KUAB8HZ",
						"iam_arn": "arn:aws:iam::cloudfront:user/CloudFront Origin Access Identity E2YSUZQQDNB6RH",
						"id": "E2YSUZQQDNB6RH",
						"s3_canonical_user_id": "df80295e0bb754c942b15d5487a498e18201e7bf5bdfcf41892361df60e933cf885a1f145ab62996f704268d5f8a8b51",
					},
					"before_sensitive": {},
				},
				"mode": "managed",
				"name": "cdn_origin_access_identity",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"type": "aws_cloudfront_origin_access_identity",
			},
			{
				"action_reason": "replace_because_cannot_update",
				"address": "aws_route53_zone.tf_sample_r53",
				"change": {
					"actions": [
						"delete",
						"create",
					],
					"after": {
						"comment": "Managed by Terraform",
						"delegation_set_id": null,
						"force_destroy": false,
						"name": "tfsampler53.com",
						"tags": null,
						"vpc": [{"vpc_id": "vpc-0349411d5238970be"}],
					},
					"after_sensitive": {
						"name_servers": [],
						"tags_all": {},
						"vpc": [{}],
					},
					"after_unknown": {
						"arn": true,
						"id": true,
						"name_servers": true,
						"tags_all": true,
						"vpc": [{"vpc_region": true}],
						"zone_id": true,
					},
					"before": {
						"arn": "arn:aws:route53:::hostedzone/Z0721299JY9JOBQ6KW4O",
						"comment": "Managed by Terraform",
						"delegation_set_id": "",
						"force_destroy": false,
						"id": "Z0721299JY9JOBQ6KW4O",
						"name": "gswebapp.com",
						"name_servers": [
							"ns-0.awsdns-00.com.",
							"ns-1024.awsdns-00.org.",
							"ns-1536.awsdns-00.co.uk.",
							"ns-512.awsdns-00.net.",
						],
						"tags": {},
						"tags_all": {},
						"vpc": [{
							"vpc_id": "vpc-0349411d5238970be",
							"vpc_region": "us-west-2",
						}],
						"zone_id": "Z0721299JY9JOBQ6KW4O",
					},
					"before_sensitive": {
						"name_servers": [
							false,
							false,
							false,
							false,
						],
						"tags": {},
						"tags_all": {},
						"vpc": [{}],
					},
					"replace_paths": [["name"]],
				},
				"mode": "managed",
				"name": "tf_sample_r53",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"type": "aws_route53_zone",
			},
			{
				"address": "aws_s3_bucket.tf_sample_s3",
				"change": {
					"actions": ["create"],
					"after": {
						"acl": "private",
						"bucket_prefix": null,
						"cors_rule": [],
						"force_destroy": false,
						"grant": [],
						"lifecycle_rule": [],
						"logging": [],
						"policy": null,
						"replication_configuration": [],
						"server_side_encryption_configuration": [],
						"tags": {
							"Name": "My bucket",
							"Purpose": "Policy Library Development",
						},
						"tags_all": {
							"Name": "My bucket",
							"Purpose": "Policy Library Development",
						},
						"website": [],
					},
					"after_sensitive": {
						"cors_rule": [],
						"grant": [],
						"lifecycle_rule": [],
						"logging": [],
						"object_lock_configuration": [],
						"replication_configuration": [],
						"server_side_encryption_configuration": [],
						"tags": {},
						"tags_all": {},
						"versioning": [],
						"website": [],
					},
					"after_unknown": {
						"acceleration_status": true,
						"arn": true,
						"bucket": true,
						"bucket_domain_name": true,
						"bucket_regional_domain_name": true,
						"cors_rule": [],
						"grant": [],
						"hosted_zone_id": true,
						"id": true,
						"lifecycle_rule": [],
						"logging": [],
						"object_lock_configuration": true,
						"object_lock_enabled": true,
						"region": true,
						"replication_configuration": [],
						"request_payer": true,
						"server_side_encryption_configuration": [],
						"tags": {},
						"tags_all": {},
						"versioning": true,
						"website": [],
						"website_domain": true,
						"website_endpoint": true,
					},
					"before": null,
					"before_sensitive": false,
				},
				"mode": "managed",
				"name": "tf_sample_s3",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"type": "aws_s3_bucket",
			},
			{
				"address": "aws_vpc.tf_sample_vpc",
				"change": {
					"actions": ["no-op"],
					"after": {
						"arn": "arn:aws:ec2:us-west-2:880619295091:vpc/vpc-0349411d5238970be",
						"assign_generated_ipv6_cidr_block": false,
						"cidr_block": "178.0.0.0/16",
						"default_network_acl_id": "acl-07a43d3efc0dbe154",
						"default_route_table_id": "rtb-06f16b2d5f4617c60",
						"default_security_group_id": "sg-065f371d5b8048334",
						"dhcp_options_id": "dopt-045bf5d92076494e2",
						"enable_classiclink": false,
						"enable_classiclink_dns_support": false,
						"enable_dns_hostnames": false,
						"enable_dns_support": true,
						"id": "vpc-0349411d5238970be",
						"instance_tenancy": "default",
						"ipv4_ipam_pool_id": null,
						"ipv4_netmask_length": null,
						"ipv6_association_id": "",
						"ipv6_cidr_block": "",
						"ipv6_cidr_block_network_border_group": "",
						"ipv6_ipam_pool_id": "",
						"ipv6_netmask_length": 0,
						"main_route_table_id": "rtb-06f16b2d5f4617c60",
						"owner_id": "880619295091",
						"tags": {"Name": "tf_sample_vpc"},
						"tags_all": {"Name": "tf_sample_vpc"},
					},
					"after_sensitive": {
						"tags": {},
						"tags_all": {},
					},
					"after_unknown": {},
					"before": {
						"arn": "arn:aws:ec2:us-west-2:880619295091:vpc/vpc-0349411d5238970be",
						"assign_generated_ipv6_cidr_block": false,
						"cidr_block": "178.0.0.0/16",
						"default_network_acl_id": "acl-07a43d3efc0dbe154",
						"default_route_table_id": "rtb-06f16b2d5f4617c60",
						"default_security_group_id": "sg-065f371d5b8048334",
						"dhcp_options_id": "dopt-045bf5d92076494e2",
						"enable_classiclink": false,
						"enable_classiclink_dns_support": false,
						"enable_dns_hostnames": false,
						"enable_dns_support": true,
						"id": "vpc-0349411d5238970be",
						"instance_tenancy": "default",
						"ipv4_ipam_pool_id": null,
						"ipv4_netmask_length": null,
						"ipv6_association_id": "",
						"ipv6_cidr_block": "",
						"ipv6_cidr_block_network_border_group": "",
						"ipv6_ipam_pool_id": "",
						"ipv6_netmask_length": 0,
						"main_route_table_id": "rtb-06f16b2d5f4617c60",
						"owner_id": "880619295091",
						"tags": {"Name": "tf_sample_vpc"},
						"tags_all": {"Name": "tf_sample_vpc"},
					},
					"before_sensitive": {
						"tags": {},
						"tags_all": {},
					},
				},
				"mode": "managed",
				"name": "tf_sample_vpc",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"type": "aws_vpc",
			},
			{
				"address": "random_string.random_val",
				"change": {
					"actions": ["create"],
					"after": {
						"keepers": null,
						"length": 4,
						"lower": true,
						"min_lower": 0,
						"min_numeric": 0,
						"min_special": 0,
						"min_upper": 0,
						"number": true,
						"override_special": ".-",
						"special": true,
						"upper": false,
					},
					"after_sensitive": {},
					"after_unknown": {
						"id": true,
						"result": true,
					},
					"before": null,
					"before_sensitive": false,
				},
				"mode": "managed",
				"name": "random_val",
				"provider_name": "registry.terraform.io/hashicorp/random",
				"type": "random_string",
			},
		],
		"resource_drift": [{
			"address": "aws_route53_zone.tf_sample_r53",
			"change": {
				"actions": ["update"],
				"after": {
					"arn": "arn:aws:route53:::hostedzone/Z0721299JY9JOBQ6KW4O",
					"comment": "Managed by Terraform",
					"delegation_set_id": "",
					"force_destroy": false,
					"id": "Z0721299JY9JOBQ6KW4O",
					"name": "gswebapp.com",
					"name_servers": [
						"ns-0.awsdns-00.com.",
						"ns-1024.awsdns-00.org.",
						"ns-1536.awsdns-00.co.uk.",
						"ns-512.awsdns-00.net.",
					],
					"tags": {},
					"tags_all": {},
					"vpc": [{
						"vpc_id": "vpc-0349411d5238970be",
						"vpc_region": "us-west-2",
					}],
					"zone_id": "Z0721299JY9JOBQ6KW4O",
				},
				"after_sensitive": {
					"name_servers": [
						false,
						false,
						false,
						false,
					],
					"tags": {},
					"tags_all": {},
					"vpc": [{}],
				},
				"after_unknown": {},
				"before": {
					"arn": "arn:aws:route53:::hostedzone/Z0721299JY9JOBQ6KW4O",
					"comment": "Managed by Terraform",
					"delegation_set_id": "",
					"force_destroy": false,
					"id": "Z0721299JY9JOBQ6KW4O",
					"name": "gswebapp.com",
					"name_servers": [
						"ns-0.awsdns-00.com.",
						"ns-1024.awsdns-00.org.",
						"ns-1536.awsdns-00.co.uk.",
						"ns-512.awsdns-00.net.",
					],
					"tags": null,
					"tags_all": {},
					"vpc": [{
						"vpc_id": "vpc-0349411d5238970be",
						"vpc_region": "us-west-2",
					}],
					"zone_id": "Z0721299JY9JOBQ6KW4O",
				},
				"before_sensitive": {
					"name_servers": [
						false,
						false,
						false,
						false,
					],
					"tags_all": {},
					"vpc": [{}],
				},
			},
			"mode": "managed",
			"name": "tf_sample_r53",
			"provider_name": "registry.terraform.io/hashicorp/aws",
			"type": "aws_route53_zone",
		}],
		"terraform_version": "1.1.9",
		"variables": {
			"region": {"value": "us-west-2"},
			"vpc_cidr": {"value": "178.0.0.0/16"},
		},
	}
}

input_cloudfront_distribution_with_ordered_cache_behavior(default_cache_behavior_viewer_protocol_policy, ordered_cache_behavior_viewer_protocol_policy) := x {
	x := {
		"format_version": "1.1",
		"terraform_version": "1.2.5",
		"variables": {
			"region": {"value": "us-west-2"},
			"vpc_cidr": {"value": "178.0.0.0/16"},
		},
		"planned_values": {"root_module": {"resources": [
			{
				"address": "aws_cloudfront_distribution.s3_distribution",
				"mode": "managed",
				"type": "aws_cloudfront_distribution",
				"name": "s3_distribution",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 1,
				"values": {
					"aliases": [
						"mysite.example.com",
						"yoursite.example.com",
					],
					"comment": "Some comment",
					"custom_error_response": [],
					"default_cache_behavior": [{
						"allowed_methods": [
							"DELETE",
							"GET",
							"HEAD",
							"OPTIONS",
							"PATCH",
							"POST",
							"PUT",
						],
						"cache_policy_id": null,
						"cached_methods": [
							"GET",
							"HEAD",
						],
						"compress": false,
						"default_ttl": 3600,
						"field_level_encryption_id": null,
						"forwarded_values": [{
							"cookies": [{"forward": "none"}],
							"query_string": false,
						}],
						"function_association": [],
						"lambda_function_association": [],
						"max_ttl": 86400,
						"min_ttl": 0,
						"origin_request_policy_id": null,
						"realtime_log_config_arn": null,
						"response_headers_policy_id": null,
						"smooth_streaming": null,
						"target_origin_id": "myS3Origin",
						"viewer_protocol_policy": default_cache_behavior_viewer_protocol_policy,
					}],
					"default_root_object": "index.html",
					"enabled": true,
					"http_version": "http2",
					"is_ipv6_enabled": true,
					"logging_config": [{
						"bucket": "mylogs.s3.amazonaws.com",
						"include_cookies": false,
						"prefix": "myprefix",
					}],
					"ordered_cache_behavior": [{
						"allowed_methods": [
							"GET",
							"HEAD",
							"OPTIONS",
						],
						"cache_policy_id": null,
						"cached_methods": [
							"GET",
							"HEAD",
							"OPTIONS",
						],
						"compress": true,
						"default_ttl": 86400,
						"field_level_encryption_id": null,
						"forwarded_values": [{
							"cookies": [{
								"forward": "none",
								"whitelisted_names": null,
							}],
							"headers": ["Origin"],
							"query_string": false,
						}],
						"function_association": [],
						"lambda_function_association": [],
						"max_ttl": 31536000,
						"min_ttl": 0,
						"origin_request_policy_id": null,
						"path_pattern": "/content/immutable/*",
						"realtime_log_config_arn": null,
						"response_headers_policy_id": null,
						"smooth_streaming": null,
						"target_origin_id": "myS3Origin",
						"trusted_key_groups": null,
						"trusted_signers": null,
						"viewer_protocol_policy": ordered_cache_behavior_viewer_protocol_policy,
					}],
					"origin": [{
						"connection_attempts": 3,
						"connection_timeout": 10,
						"custom_header": [],
						"custom_origin_config": [],
						"origin_id": "myS3Origin",
						"origin_path": "",
						"origin_shield": [],
						"s3_origin_config": [{"origin_access_identity": "origin-access-identity/cloudfront/ABCDEFG1234567"}],
					}],
					"origin_group": [],
					"price_class": "PriceClass_200",
					"restrictions": [{"geo_restriction": [{
						"locations": [
							"CA",
							"DE",
							"GB",
							"US",
						],
						"restriction_type": "whitelist",
					}]}],
					"retain_on_delete": false,
					"tags": {"Environment": "production"},
					"tags_all": {"Environment": "production"},
					"viewer_certificate": [{
						"acm_certificate_arn": null,
						"cloudfront_default_certificate": true,
						"iam_certificate_id": null,
						"minimum_protocol_version": "TLSv1",
						"ssl_support_method": null,
					}],
					"wait_for_deployment": true,
					"web_acl_id": null,
				},
				"sensitive_values": {
					"aliases": [
						false,
						false,
					],
					"custom_error_response": [],
					"default_cache_behavior": [{
						"allowed_methods": [
							false,
							false,
							false,
							false,
							false,
							false,
							false,
						],
						"cached_methods": [
							false,
							false,
						],
						"forwarded_values": [{
							"cookies": [{"whitelisted_names": []}],
							"headers": [],
							"query_string_cache_keys": [],
						}],
						"function_association": [],
						"lambda_function_association": [],
						"trusted_key_groups": [],
						"trusted_signers": [],
					}],
					"logging_config": [{}],
					"ordered_cache_behavior": [{
						"allowed_methods": [
							false,
							false,
							false,
						],
						"cached_methods": [
							false,
							false,
							false,
						],
						"forwarded_values": [{
							"cookies": [{}],
							"headers": [false],
							"query_string_cache_keys": [],
						}],
						"function_association": [],
						"lambda_function_association": [],
					}],
					"origin": [{
						"custom_header": [],
						"custom_origin_config": [],
						"origin_shield": [],
						"s3_origin_config": [{}],
					}],
					"origin_group": [],
					"restrictions": [{"geo_restriction": [{"locations": [
						false,
						false,
						false,
						false,
					]}]}],
					"tags": {},
					"tags_all": {},
					"trusted_key_groups": [],
					"trusted_signers": [],
					"viewer_certificate": [{}],
				},
			},
			{
				"address": "aws_s3_bucket.b",
				"mode": "managed",
				"type": "aws_s3_bucket",
				"name": "b",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 0,
				"values": {
					"acl": "private",
					"bucket": "mybucket",
					"bucket_prefix": null,
					"cors_rule": [],
					"force_destroy": false,
					"grant": [],
					"lifecycle_rule": [],
					"logging": [],
					"policy": null,
					"replication_configuration": [],
					"server_side_encryption_configuration": [],
					"tags": {"Name": "My bucket"},
					"tags_all": {"Name": "My bucket"},
					"website": [],
				},
				"sensitive_values": {
					"cors_rule": [],
					"grant": [],
					"lifecycle_rule": [],
					"logging": [],
					"object_lock_configuration": [],
					"replication_configuration": [],
					"server_side_encryption_configuration": [],
					"tags": {},
					"tags_all": {},
					"versioning": [],
					"website": [],
				},
			},
			{
				"address": "aws_s3_bucket_acl.b_acl",
				"mode": "managed",
				"type": "aws_s3_bucket_acl",
				"name": "b_acl",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 0,
				"values": {
					"acl": "private",
					"expected_bucket_owner": null,
				},
				"sensitive_values": {"access_control_policy": []},
			},
		]}},
		"resource_changes": [
			{
				"address": "aws_cloudfront_distribution.s3_distribution",
				"mode": "managed",
				"type": "aws_cloudfront_distribution",
				"name": "s3_distribution",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"aliases": [
							"mysite.example.com",
							"yoursite.example.com",
						],
						"comment": "Some comment",
						"custom_error_response": [],
						"default_cache_behavior": [{
							"allowed_methods": [
								"DELETE",
								"GET",
								"HEAD",
								"OPTIONS",
								"PATCH",
								"POST",
								"PUT",
							],
							"cache_policy_id": null,
							"cached_methods": [
								"GET",
								"HEAD",
							],
							"compress": false,
							"default_ttl": 3600,
							"field_level_encryption_id": null,
							"forwarded_values": [{
								"cookies": [{"forward": "none"}],
								"query_string": false,
							}],
							"function_association": [],
							"lambda_function_association": [],
							"max_ttl": 86400,
							"min_ttl": 0,
							"origin_request_policy_id": null,
							"realtime_log_config_arn": null,
							"response_headers_policy_id": null,
							"smooth_streaming": null,
							"target_origin_id": "myS3Origin",
							"viewer_protocol_policy": default_cache_behavior_viewer_protocol_policy,
						}],
						"default_root_object": "index.html",
						"enabled": true,
						"http_version": "http2",
						"is_ipv6_enabled": true,
						"logging_config": [{
							"bucket": "mylogs.s3.amazonaws.com",
							"include_cookies": false,
							"prefix": "myprefix",
						}],
						"ordered_cache_behavior": [{
							"allowed_methods": [
								"GET",
								"HEAD",
								"OPTIONS",
							],
							"cache_policy_id": null,
							"cached_methods": [
								"GET",
								"HEAD",
								"OPTIONS",
							],
							"compress": true,
							"default_ttl": 86400,
							"field_level_encryption_id": null,
							"forwarded_values": [{
								"cookies": [{
									"forward": "none",
									"whitelisted_names": null,
								}],
								"headers": ["Origin"],
								"query_string": false,
							}],
							"function_association": [],
							"lambda_function_association": [],
							"max_ttl": 31536000,
							"min_ttl": 0,
							"origin_request_policy_id": null,
							"path_pattern": "/content/immutable/*",
							"realtime_log_config_arn": null,
							"response_headers_policy_id": null,
							"smooth_streaming": null,
							"target_origin_id": "myS3Origin",
							"trusted_key_groups": null,
							"trusted_signers": null,
							"viewer_protocol_policy": ordered_cache_behavior_viewer_protocol_policy,
						}],
						"origin": [{
							"connection_attempts": 3,
							"connection_timeout": 10,
							"custom_header": [],
							"custom_origin_config": [],
							"origin_id": "myS3Origin",
							"origin_path": "",
							"origin_shield": [],
							"s3_origin_config": [{"origin_access_identity": "origin-access-identity/cloudfront/ABCDEFG1234567"}],
						}],
						"origin_group": [],
						"price_class": "PriceClass_200",
						"restrictions": [{"geo_restriction": [{
							"locations": [
								"CA",
								"DE",
								"GB",
								"US",
							],
							"restriction_type": "whitelist",
						}]}],
						"retain_on_delete": false,
						"tags": {"Environment": "production"},
						"tags_all": {"Environment": "production"},
						"viewer_certificate": [{
							"acm_certificate_arn": null,
							"cloudfront_default_certificate": true,
							"iam_certificate_id": null,
							"minimum_protocol_version": "TLSv1",
							"ssl_support_method": null,
						}],
						"wait_for_deployment": true,
						"web_acl_id": null,
					},
					"after_unknown": {
						"aliases": [
							false,
							false,
						],
						"arn": true,
						"caller_reference": true,
						"custom_error_response": [],
						"default_cache_behavior": [{
							"allowed_methods": [
								false,
								false,
								false,
								false,
								false,
								false,
								false,
							],
							"cached_methods": [
								false,
								false,
							],
							"forwarded_values": [{
								"cookies": [{"whitelisted_names": true}],
								"headers": true,
								"query_string_cache_keys": true,
							}],
							"function_association": [],
							"lambda_function_association": [],
							"trusted_key_groups": true,
							"trusted_signers": true,
						}],
						"domain_name": true,
						"etag": true,
						"hosted_zone_id": true,
						"id": true,
						"in_progress_validation_batches": true,
						"last_modified_time": true,
						"logging_config": [{}],
						"ordered_cache_behavior": [{
							"allowed_methods": [
								false,
								false,
								false,
							],
							"cached_methods": [
								false,
								false,
								false,
							],
							"forwarded_values": [{
								"cookies": [{}],
								"headers": [false],
								"query_string_cache_keys": true,
							}],
							"function_association": [],
							"lambda_function_association": [],
						}],
						"origin": [{
							"custom_header": [],
							"custom_origin_config": [],
							"domain_name": true,
							"origin_shield": [],
							"s3_origin_config": [{}],
						}],
						"origin_group": [],
						"restrictions": [{"geo_restriction": [{"locations": [
							false,
							false,
							false,
							false,
						]}]}],
						"status": true,
						"tags": {},
						"tags_all": {},
						"trusted_key_groups": true,
						"trusted_signers": true,
						"viewer_certificate": [{}],
					},
					"before_sensitive": false,
					"after_sensitive": {
						"aliases": [
							false,
							false,
						],
						"custom_error_response": [],
						"default_cache_behavior": [{
							"allowed_methods": [
								false,
								false,
								false,
								false,
								false,
								false,
								false,
							],
							"cached_methods": [
								false,
								false,
							],
							"forwarded_values": [{
								"cookies": [{"whitelisted_names": []}],
								"headers": [],
								"query_string_cache_keys": [],
							}],
							"function_association": [],
							"lambda_function_association": [],
							"trusted_key_groups": [],
							"trusted_signers": [],
						}],
						"logging_config": [{}],
						"ordered_cache_behavior": [{
							"allowed_methods": [
								false,
								false,
								false,
							],
							"cached_methods": [
								false,
								false,
								false,
							],
							"forwarded_values": [{
								"cookies": [{}],
								"headers": [false],
								"query_string_cache_keys": [],
							}],
							"function_association": [],
							"lambda_function_association": [],
						}],
						"origin": [{
							"custom_header": [],
							"custom_origin_config": [],
							"origin_shield": [],
							"s3_origin_config": [{}],
						}],
						"origin_group": [],
						"restrictions": [{"geo_restriction": [{"locations": [
							false,
							false,
							false,
							false,
						]}]}],
						"tags": {},
						"tags_all": {},
						"trusted_key_groups": [],
						"trusted_signers": [],
						"viewer_certificate": [{}],
					},
				},
			},
			{
				"address": "aws_s3_bucket.b",
				"mode": "managed",
				"type": "aws_s3_bucket",
				"name": "b",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"acl": "private",
						"bucket": "mybucket",
						"bucket_prefix": null,
						"cors_rule": [],
						"force_destroy": false,
						"grant": [],
						"lifecycle_rule": [],
						"logging": [],
						"policy": null,
						"replication_configuration": [],
						"server_side_encryption_configuration": [],
						"tags": {"Name": "My bucket"},
						"tags_all": {"Name": "My bucket"},
						"website": [],
					},
					"after_unknown": {
						"acceleration_status": true,
						"arn": true,
						"bucket_domain_name": true,
						"bucket_regional_domain_name": true,
						"cors_rule": [],
						"grant": [],
						"hosted_zone_id": true,
						"id": true,
						"lifecycle_rule": [],
						"logging": [],
						"object_lock_configuration": true,
						"object_lock_enabled": true,
						"region": true,
						"replication_configuration": [],
						"request_payer": true,
						"server_side_encryption_configuration": [],
						"tags": {},
						"tags_all": {},
						"versioning": true,
						"website": [],
						"website_domain": true,
						"website_endpoint": true,
					},
					"before_sensitive": false,
					"after_sensitive": {
						"cors_rule": [],
						"grant": [],
						"lifecycle_rule": [],
						"logging": [],
						"object_lock_configuration": [],
						"replication_configuration": [],
						"server_side_encryption_configuration": [],
						"tags": {},
						"tags_all": {},
						"versioning": [],
						"website": [],
					},
				},
			},
			{
				"address": "aws_s3_bucket_acl.b_acl",
				"mode": "managed",
				"type": "aws_s3_bucket_acl",
				"name": "b_acl",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"acl": "private",
						"expected_bucket_owner": null,
					},
					"after_unknown": {
						"access_control_policy": true,
						"bucket": true,
						"id": true,
					},
					"before_sensitive": false,
					"after_sensitive": {"access_control_policy": []},
				},
			},
		],
		"configuration": {
			"provider_config": {"aws": {
				"name": "aws",
				"full_name": "registry.terraform.io/hashicorp/aws",
				"version_constraint": "~> 3.27",
				"expressions": {
					"profile": {"constant_value": "default"},
					"region": {"references": ["var.region"]},
				},
			}},
			"root_module": {
				"resources": [
					{
						"address": "aws_cloudfront_distribution.s3_distribution",
						"mode": "managed",
						"type": "aws_cloudfront_distribution",
						"name": "s3_distribution",
						"provider_config_key": "aws",
						"expressions": {
							"aliases": {"constant_value": [
								"mysite.example.com",
								"yoursite.example.com",
							]},
							"comment": {"constant_value": "Some comment"},
							"default_cache_behavior": [{
								"allowed_methods": {"constant_value": [
									"DELETE",
									"GET",
									"HEAD",
									"OPTIONS",
									"PATCH",
									"POST",
									"PUT",
								]},
								"cached_methods": {"constant_value": [
									"GET",
									"HEAD",
								]},
								"default_ttl": {"constant_value": 3600},
								"forwarded_values": [{
									"cookies": [{"forward": {"constant_value": "none"}}],
									"query_string": {"constant_value": false},
								}],
								"max_ttl": {"constant_value": 86400},
								"min_ttl": {"constant_value": 0},
								"target_origin_id": {"references": ["local.s3_origin_id"]},
								"viewer_protocol_policy": {"constant_value": "allow-all"},
							}],
							"default_root_object": {"constant_value": "index.html"},
							"enabled": {"constant_value": true},
							"is_ipv6_enabled": {"constant_value": true},
							"logging_config": [{
								"bucket": {"constant_value": "mylogs.s3.amazonaws.com"},
								"include_cookies": {"constant_value": false},
								"prefix": {"constant_value": "myprefix"},
							}],
							"ordered_cache_behavior": [{
								"allowed_methods": {"constant_value": [
									"GET",
									"HEAD",
									"OPTIONS",
								]},
								"cached_methods": {"constant_value": [
									"GET",
									"HEAD",
									"OPTIONS",
								]},
								"compress": {"constant_value": true},
								"default_ttl": {"constant_value": 86400},
								"forwarded_values": [{
									"cookies": [{"forward": {"constant_value": "none"}}],
									"headers": {"constant_value": ["Origin"]},
									"query_string": {"constant_value": false},
								}],
								"max_ttl": {"constant_value": 31536000},
								"min_ttl": {"constant_value": 0},
								"path_pattern": {"constant_value": "/content/immutable/*"},
								"target_origin_id": {"references": ["local.s3_origin_id"]},
								"viewer_protocol_policy": {"constant_value": "redirect-to-https"},
							}],
							"origin": [{
								"domain_name": {"references": [
									"aws_s3_bucket.b.bucket_regional_domain_name",
									"aws_s3_bucket.b",
								]},
								"origin_id": {"references": ["local.s3_origin_id"]},
								"s3_origin_config": [{"origin_access_identity": {"constant_value": "origin-access-identity/cloudfront/ABCDEFG1234567"}}],
							}],
							"price_class": {"constant_value": "PriceClass_200"},
							"restrictions": [{"geo_restriction": [{
								"locations": {"constant_value": [
									"US",
									"CA",
									"GB",
									"DE",
								]},
								"restriction_type": {"constant_value": "whitelist"},
							}]}],
							"tags": {"constant_value": {"Environment": "production"}},
							"viewer_certificate": [{"cloudfront_default_certificate": {"constant_value": true}}],
						},
						"schema_version": 1,
					},
					{
						"address": "aws_s3_bucket.b",
						"mode": "managed",
						"type": "aws_s3_bucket",
						"name": "b",
						"provider_config_key": "aws",
						"expressions": {
							"bucket": {"constant_value": "mybucket"},
							"tags": {"constant_value": {"Name": "My bucket"}},
						},
						"schema_version": 0,
					},
					{
						"address": "aws_s3_bucket_acl.b_acl",
						"mode": "managed",
						"type": "aws_s3_bucket_acl",
						"name": "b_acl",
						"provider_config_key": "aws",
						"expressions": {
							"acl": {"constant_value": "private"},
							"bucket": {"references": [
								"aws_s3_bucket.b.id",
								"aws_s3_bucket.b",
							]},
						},
						"schema_version": 0,
					},
				],
				"variables": {
					"region": {"default": "us-west-2"},
					"vpc_cidr": {"default": "178.0.0.0/16"},
				},
			},
		},
		"relevant_attributes": [
			{
				"resource": "aws_s3_bucket.b",
				"attribute": ["id"],
			},
			{
				"resource": "aws_s3_bucket.b",
				"attribute": ["bucket_regional_domain_name"],
			},
		],
	}
}

input_cloudfront_distribution_with_multiple_ordered_cache_behavior(default_cache_behavior_viewer_protocol_policy, ordered_cache_behavior_viewer_protocol_policy_1, ordered_cache_behavior_viewer_protocol_policy_2) := x {
	x := {
		"configuration": {
			"provider_config": {"aws": {
				"expressions": {
					"profile": {"constant_value": "default"},
					"region": {"references": ["var.region"]},
				},
				"full_name": "registry.terraform.io/hashicorp/aws",
				"name": "aws",
				"version_constraint": "~> 3.27",
			}},
			"root_module": {
				"resources": [
					{
						"address": "aws_cloudfront_distribution.s3_distribution",
						"expressions": {
							"aliases": {"constant_value": [
								"mysite.example.com",
								"yoursite.example.com",
							]},
							"comment": {"constant_value": "Some comment"},
							"default_cache_behavior": [{
								"allowed_methods": {"constant_value": [
									"DELETE",
									"GET",
									"HEAD",
									"OPTIONS",
									"PATCH",
									"POST",
									"PUT",
								]},
								"cached_methods": {"constant_value": [
									"GET",
									"HEAD",
								]},
								"default_ttl": {"constant_value": 3600},
								"forwarded_values": [{
									"cookies": [{"forward": {"constant_value": "none"}}],
									"query_string": {"constant_value": false},
								}],
								"max_ttl": {"constant_value": 86400},
								"min_ttl": {"constant_value": 0},
								"target_origin_id": {"references": ["local.s3_origin_id"]},
								"viewer_protocol_policy": {"constant_value": "allow-all"},
							}],
							"default_root_object": {"constant_value": "index.html"},
							"enabled": {"constant_value": true},
							"is_ipv6_enabled": {"constant_value": true},
							"logging_config": [{
								"bucket": {"constant_value": "mylogs.s3.amazonaws.com"},
								"include_cookies": {"constant_value": false},
								"prefix": {"constant_value": "myprefix"},
							}],
							"ordered_cache_behavior": [
								{
									"allowed_methods": {"constant_value": [
										"GET",
										"HEAD",
										"OPTIONS",
									]},
									"cached_methods": {"constant_value": [
										"GET",
										"HEAD",
										"OPTIONS",
									]},
									"compress": {"constant_value": true},
									"default_ttl": {"constant_value": 86400},
									"forwarded_values": [{
										"cookies": [{"forward": {"constant_value": "none"}}],
										"headers": {"constant_value": ["Origin"]},
										"query_string": {"constant_value": false},
									}],
									"max_ttl": {"constant_value": 31536000},
									"min_ttl": {"constant_value": 0},
									"path_pattern": {"constant_value": "/content/immutable/*"},
									"target_origin_id": {"references": ["local.s3_origin_id"]},
									"viewer_protocol_policy": {"constant_value": "redirect-to-https"},
								},
								{
									"allowed_methods": {"constant_value": [
										"GET",
										"HEAD",
										"OPTIONS",
									]},
									"cached_methods": {"constant_value": [
										"GET",
										"HEAD",
									]},
									"compress": {"constant_value": true},
									"default_ttl": {"constant_value": 3600},
									"forwarded_values": [{
										"cookies": [{"forward": {"constant_value": "none"}}],
										"query_string": {"constant_value": false},
									}],
									"max_ttl": {"constant_value": 86400},
									"min_ttl": {"constant_value": 0},
									"path_pattern": {"constant_value": "/content/*"},
									"target_origin_id": {"references": ["local.s3_origin_id"]},
									"viewer_protocol_policy": {"constant_value": "redirect-to-https"},
								},
							],
							"origin": [{
								"domain_name": {"references": [
									"aws_s3_bucket.b.bucket_regional_domain_name",
									"aws_s3_bucket.b",
								]},
								"origin_id": {"references": ["local.s3_origin_id"]},
								"s3_origin_config": [{"origin_access_identity": {"constant_value": "origin-access-identity/cloudfront/ABCDEFG1234567"}}],
							}],
							"price_class": {"constant_value": "PriceClass_200"},
							"restrictions": [{"geo_restriction": [{
								"locations": {"constant_value": [
									"US",
									"CA",
									"GB",
									"DE",
								]},
								"restriction_type": {"constant_value": "whitelist"},
							}]}],
							"tags": {"constant_value": {"Environment": "production"}},
							"viewer_certificate": [{"cloudfront_default_certificate": {"constant_value": true}}],
						},
						"mode": "managed",
						"name": "s3_distribution",
						"provider_config_key": "aws",
						"schema_version": 1,
						"type": "aws_cloudfront_distribution",
					},
					{
						"address": "aws_s3_bucket.b",
						"expressions": {
							"bucket": {"constant_value": "mybucket"},
							"tags": {"constant_value": {"Name": "My bucket"}},
						},
						"mode": "managed",
						"name": "b",
						"provider_config_key": "aws",
						"schema_version": 0,
						"type": "aws_s3_bucket",
					},
					{
						"address": "aws_s3_bucket_acl.b_acl",
						"expressions": {
							"acl": {"constant_value": "private"},
							"bucket": {"references": [
								"aws_s3_bucket.b.id",
								"aws_s3_bucket.b",
							]},
						},
						"mode": "managed",
						"name": "b_acl",
						"provider_config_key": "aws",
						"schema_version": 0,
						"type": "aws_s3_bucket_acl",
					},
				],
				"variables": {
					"region": {"default": "us-west-2"},
					"vpc_cidr": {"default": "178.0.0.0/16"},
				},
			},
		},
		"format_version": "1.1",
		"planned_values": {"root_module": {"resources": [
			{
				"address": "aws_cloudfront_distribution.s3_distribution",
				"mode": "managed",
				"name": "s3_distribution",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 1,
				"sensitive_values": {
					"aliases": [
						false,
						false,
					],
					"custom_error_response": [],
					"default_cache_behavior": [{
						"allowed_methods": [
							false,
							false,
							false,
							false,
							false,
							false,
							false,
						],
						"cached_methods": [
							false,
							false,
						],
						"forwarded_values": [{
							"cookies": [{"whitelisted_names": []}],
							"headers": [],
							"query_string_cache_keys": [],
						}],
						"function_association": [],
						"lambda_function_association": [],
						"trusted_key_groups": [],
						"trusted_signers": [],
					}],
					"logging_config": [{}],
					"ordered_cache_behavior": [
						{
							"allowed_methods": [
								false,
								false,
								false,
							],
							"cached_methods": [
								false,
								false,
								false,
							],
							"forwarded_values": [{
								"cookies": [{}],
								"headers": [false],
								"query_string_cache_keys": [],
							}],
							"function_association": [],
							"lambda_function_association": [],
						},
						{
							"allowed_methods": [
								false,
								false,
								false,
							],
							"cached_methods": [
								false,
								false,
							],
							"forwarded_values": [{
								"cookies": [{}],
								"headers": [],
								"query_string_cache_keys": [],
							}],
							"function_association": [],
							"lambda_function_association": [],
						},
					],
					"origin": [{
						"custom_header": [],
						"custom_origin_config": [],
						"origin_shield": [],
						"s3_origin_config": [{}],
					}],
					"origin_group": [],
					"restrictions": [{"geo_restriction": [{"locations": [
						false,
						false,
						false,
						false,
					]}]}],
					"tags": {},
					"tags_all": {},
					"trusted_key_groups": [],
					"trusted_signers": [],
					"viewer_certificate": [{}],
				},
				"type": "aws_cloudfront_distribution",
				"values": {
					"aliases": [
						"mysite.example.com",
						"yoursite.example.com",
					],
					"comment": "Some comment",
					"custom_error_response": [],
					"default_cache_behavior": [{
						"allowed_methods": [
							"DELETE",
							"GET",
							"HEAD",
							"OPTIONS",
							"PATCH",
							"POST",
							"PUT",
						],
						"cache_policy_id": null,
						"cached_methods": [
							"GET",
							"HEAD",
						],
						"compress": false,
						"default_ttl": 3600,
						"field_level_encryption_id": null,
						"forwarded_values": [{
							"cookies": [{"forward": "none"}],
							"query_string": false,
						}],
						"function_association": [],
						"lambda_function_association": [],
						"max_ttl": 86400,
						"min_ttl": 0,
						"origin_request_policy_id": null,
						"realtime_log_config_arn": null,
						"response_headers_policy_id": null,
						"smooth_streaming": null,
						"target_origin_id": "myS3Origin",
						"viewer_protocol_policy": default_cache_behavior_viewer_protocol_policy,
					}],
					"default_root_object": "index.html",
					"enabled": true,
					"http_version": "http2",
					"is_ipv6_enabled": true,
					"logging_config": [{
						"bucket": "mylogs.s3.amazonaws.com",
						"include_cookies": false,
						"prefix": "myprefix",
					}],
					"ordered_cache_behavior": [
						{
							"allowed_methods": [
								"GET",
								"HEAD",
								"OPTIONS",
							],
							"cache_policy_id": null,
							"cached_methods": [
								"GET",
								"HEAD",
								"OPTIONS",
							],
							"compress": true,
							"default_ttl": 86400,
							"field_level_encryption_id": null,
							"forwarded_values": [{
								"cookies": [{
									"forward": "none",
									"whitelisted_names": null,
								}],
								"headers": ["Origin"],
								"query_string": false,
							}],
							"function_association": [],
							"lambda_function_association": [],
							"max_ttl": 31536000,
							"min_ttl": 0,
							"origin_request_policy_id": null,
							"path_pattern": "/content/immutable/*",
							"realtime_log_config_arn": null,
							"response_headers_policy_id": null,
							"smooth_streaming": null,
							"target_origin_id": "myS3Origin",
							"trusted_key_groups": null,
							"trusted_signers": null,
							"viewer_protocol_policy": ordered_cache_behavior_viewer_protocol_policy_1,
						},
						{
							"allowed_methods": [
								"GET",
								"HEAD",
								"OPTIONS",
							],
							"cache_policy_id": null,
							"cached_methods": [
								"GET",
								"HEAD",
							],
							"compress": true,
							"default_ttl": 3600,
							"field_level_encryption_id": null,
							"forwarded_values": [{
								"cookies": [{
									"forward": "none",
									"whitelisted_names": null,
								}],
								"query_string": false,
							}],
							"function_association": [],
							"lambda_function_association": [],
							"max_ttl": 86400,
							"min_ttl": 0,
							"origin_request_policy_id": null,
							"path_pattern": "/content/*",
							"realtime_log_config_arn": null,
							"response_headers_policy_id": null,
							"smooth_streaming": null,
							"target_origin_id": "myS3Origin",
							"trusted_key_groups": null,
							"trusted_signers": null,
							"viewer_protocol_policy": ordered_cache_behavior_viewer_protocol_policy_2,
						},
					],
					"origin": [{
						"connection_attempts": 3,
						"connection_timeout": 10,
						"custom_header": [],
						"custom_origin_config": [],
						"origin_id": "myS3Origin",
						"origin_path": "",
						"origin_shield": [],
						"s3_origin_config": [{"origin_access_identity": "origin-access-identity/cloudfront/ABCDEFG1234567"}],
					}],
					"origin_group": [],
					"price_class": "PriceClass_200",
					"restrictions": [{"geo_restriction": [{
						"locations": [
							"CA",
							"DE",
							"GB",
							"US",
						],
						"restriction_type": "whitelist",
					}]}],
					"retain_on_delete": false,
					"tags": {"Environment": "production"},
					"tags_all": {"Environment": "production"},
					"viewer_certificate": [{
						"acm_certificate_arn": null,
						"cloudfront_default_certificate": true,
						"iam_certificate_id": null,
						"minimum_protocol_version": "TLSv1",
						"ssl_support_method": null,
					}],
					"wait_for_deployment": true,
					"web_acl_id": null,
				},
			},
			{
				"address": "aws_s3_bucket.b",
				"mode": "managed",
				"name": "b",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 0,
				"sensitive_values": {
					"cors_rule": [],
					"grant": [],
					"lifecycle_rule": [],
					"logging": [],
					"object_lock_configuration": [],
					"replication_configuration": [],
					"server_side_encryption_configuration": [],
					"tags": {},
					"tags_all": {},
					"versioning": [],
					"website": [],
				},
				"type": "aws_s3_bucket",
				"values": {
					"acl": "private",
					"bucket": "mybucket",
					"bucket_prefix": null,
					"cors_rule": [],
					"force_destroy": false,
					"grant": [],
					"lifecycle_rule": [],
					"logging": [],
					"policy": null,
					"replication_configuration": [],
					"server_side_encryption_configuration": [],
					"tags": {"Name": "My bucket"},
					"tags_all": {"Name": "My bucket"},
					"website": [],
				},
			},
			{
				"address": "aws_s3_bucket_acl.b_acl",
				"mode": "managed",
				"name": "b_acl",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 0,
				"sensitive_values": {"access_control_policy": []},
				"type": "aws_s3_bucket_acl",
				"values": {
					"acl": "private",
					"expected_bucket_owner": null,
				},
			},
		]}},
		"relevant_attributes": [
			{
				"attribute": ["id"],
				"resource": "aws_s3_bucket.b",
			},
			{
				"attribute": ["bucket_regional_domain_name"],
				"resource": "aws_s3_bucket.b",
			},
		],
		"resource_changes": [
			{
				"address": "aws_cloudfront_distribution.s3_distribution",
				"change": {
					"actions": ["create"],
					"after": {
						"aliases": [
							"mysite.example.com",
							"yoursite.example.com",
						],
						"comment": "Some comment",
						"custom_error_response": [],
						"default_cache_behavior": [{
							"allowed_methods": [
								"DELETE",
								"GET",
								"HEAD",
								"OPTIONS",
								"PATCH",
								"POST",
								"PUT",
							],
							"cache_policy_id": null,
							"cached_methods": [
								"GET",
								"HEAD",
							],
							"compress": false,
							"default_ttl": 3600,
							"field_level_encryption_id": null,
							"forwarded_values": [{
								"cookies": [{"forward": "none"}],
								"query_string": false,
							}],
							"function_association": [],
							"lambda_function_association": [],
							"max_ttl": 86400,
							"min_ttl": 0,
							"origin_request_policy_id": null,
							"realtime_log_config_arn": null,
							"response_headers_policy_id": null,
							"smooth_streaming": null,
							"target_origin_id": "myS3Origin",
							"viewer_protocol_policy": default_cache_behavior_viewer_protocol_policy,
						}],
						"default_root_object": "index.html",
						"enabled": true,
						"http_version": "http2",
						"is_ipv6_enabled": true,
						"logging_config": [{
							"bucket": "mylogs.s3.amazonaws.com",
							"include_cookies": false,
							"prefix": "myprefix",
						}],
						"ordered_cache_behavior": [
							{
								"allowed_methods": [
									"GET",
									"HEAD",
									"OPTIONS",
								],
								"cache_policy_id": null,
								"cached_methods": [
									"GET",
									"HEAD",
									"OPTIONS",
								],
								"compress": true,
								"default_ttl": 86400,
								"field_level_encryption_id": null,
								"forwarded_values": [{
									"cookies": [{
										"forward": "none",
										"whitelisted_names": null,
									}],
									"headers": ["Origin"],
									"query_string": false,
								}],
								"function_association": [],
								"lambda_function_association": [],
								"max_ttl": 31536000,
								"min_ttl": 0,
								"origin_request_policy_id": null,
								"path_pattern": "/content/immutable/*",
								"realtime_log_config_arn": null,
								"response_headers_policy_id": null,
								"smooth_streaming": null,
								"target_origin_id": "myS3Origin",
								"trusted_key_groups": null,
								"trusted_signers": null,
								"viewer_protocol_policy": ordered_cache_behavior_viewer_protocol_policy_1,
							},
							{
								"allowed_methods": [
									"GET",
									"HEAD",
									"OPTIONS",
								],
								"cache_policy_id": null,
								"cached_methods": [
									"GET",
									"HEAD",
								],
								"compress": true,
								"default_ttl": 3600,
								"field_level_encryption_id": null,
								"forwarded_values": [{
									"cookies": [{
										"forward": "none",
										"whitelisted_names": null,
									}],
									"query_string": false,
								}],
								"function_association": [],
								"lambda_function_association": [],
								"max_ttl": 86400,
								"min_ttl": 0,
								"origin_request_policy_id": null,
								"path_pattern": "/content/*",
								"realtime_log_config_arn": null,
								"response_headers_policy_id": null,
								"smooth_streaming": null,
								"target_origin_id": "myS3Origin",
								"trusted_key_groups": null,
								"trusted_signers": null,
								"viewer_protocol_policy": ordered_cache_behavior_viewer_protocol_policy_2,
							},
						],
						"origin": [{
							"connection_attempts": 3,
							"connection_timeout": 10,
							"custom_header": [],
							"custom_origin_config": [],
							"origin_id": "myS3Origin",
							"origin_path": "",
							"origin_shield": [],
							"s3_origin_config": [{"origin_access_identity": "origin-access-identity/cloudfront/ABCDEFG1234567"}],
						}],
						"origin_group": [],
						"price_class": "PriceClass_200",
						"restrictions": [{"geo_restriction": [{
							"locations": [
								"CA",
								"DE",
								"GB",
								"US",
							],
							"restriction_type": "whitelist",
						}]}],
						"retain_on_delete": false,
						"tags": {"Environment": "production"},
						"tags_all": {"Environment": "production"},
						"viewer_certificate": [{
							"acm_certificate_arn": null,
							"cloudfront_default_certificate": true,
							"iam_certificate_id": null,
							"minimum_protocol_version": "TLSv1",
							"ssl_support_method": null,
						}],
						"wait_for_deployment": true,
						"web_acl_id": null,
					},
					"after_sensitive": {
						"aliases": [
							false,
							false,
						],
						"custom_error_response": [],
						"default_cache_behavior": [{
							"allowed_methods": [
								false,
								false,
								false,
								false,
								false,
								false,
								false,
							],
							"cached_methods": [
								false,
								false,
							],
							"forwarded_values": [{
								"cookies": [{"whitelisted_names": []}],
								"headers": [],
								"query_string_cache_keys": [],
							}],
							"function_association": [],
							"lambda_function_association": [],
							"trusted_key_groups": [],
							"trusted_signers": [],
						}],
						"logging_config": [{}],
						"ordered_cache_behavior": [
							{
								"allowed_methods": [
									false,
									false,
									false,
								],
								"cached_methods": [
									false,
									false,
									false,
								],
								"forwarded_values": [{
									"cookies": [{}],
									"headers": [false],
									"query_string_cache_keys": [],
								}],
								"function_association": [],
								"lambda_function_association": [],
							},
							{
								"allowed_methods": [
									false,
									false,
									false,
								],
								"cached_methods": [
									false,
									false,
								],
								"forwarded_values": [{
									"cookies": [{}],
									"headers": [],
									"query_string_cache_keys": [],
								}],
								"function_association": [],
								"lambda_function_association": [],
							},
						],
						"origin": [{
							"custom_header": [],
							"custom_origin_config": [],
							"origin_shield": [],
							"s3_origin_config": [{}],
						}],
						"origin_group": [],
						"restrictions": [{"geo_restriction": [{"locations": [
							false,
							false,
							false,
							false,
						]}]}],
						"tags": {},
						"tags_all": {},
						"trusted_key_groups": [],
						"trusted_signers": [],
						"viewer_certificate": [{}],
					},
					"after_unknown": {
						"aliases": [
							false,
							false,
						],
						"arn": true,
						"caller_reference": true,
						"custom_error_response": [],
						"default_cache_behavior": [{
							"allowed_methods": [
								false,
								false,
								false,
								false,
								false,
								false,
								false,
							],
							"cached_methods": [
								false,
								false,
							],
							"forwarded_values": [{
								"cookies": [{"whitelisted_names": true}],
								"headers": true,
								"query_string_cache_keys": true,
							}],
							"function_association": [],
							"lambda_function_association": [],
							"trusted_key_groups": true,
							"trusted_signers": true,
						}],
						"domain_name": true,
						"etag": true,
						"hosted_zone_id": true,
						"id": true,
						"in_progress_validation_batches": true,
						"last_modified_time": true,
						"logging_config": [{}],
						"ordered_cache_behavior": [
							{
								"allowed_methods": [
									false,
									false,
									false,
								],
								"cached_methods": [
									false,
									false,
									false,
								],
								"forwarded_values": [{
									"cookies": [{}],
									"headers": [false],
									"query_string_cache_keys": true,
								}],
								"function_association": [],
								"lambda_function_association": [],
							},
							{
								"allowed_methods": [
									false,
									false,
									false,
								],
								"cached_methods": [
									false,
									false,
								],
								"forwarded_values": [{
									"cookies": [{}],
									"headers": true,
									"query_string_cache_keys": true,
								}],
								"function_association": [],
								"lambda_function_association": [],
							},
						],
						"origin": [{
							"custom_header": [],
							"custom_origin_config": [],
							"domain_name": true,
							"origin_shield": [],
							"s3_origin_config": [{}],
						}],
						"origin_group": [],
						"restrictions": [{"geo_restriction": [{"locations": [
							false,
							false,
							false,
							false,
						]}]}],
						"status": true,
						"tags": {},
						"tags_all": {},
						"trusted_key_groups": true,
						"trusted_signers": true,
						"viewer_certificate": [{}],
					},
					"before": null,
					"before_sensitive": false,
				},
				"mode": "managed",
				"name": "s3_distribution",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"type": "aws_cloudfront_distribution",
			},
			{
				"address": "aws_s3_bucket.b",
				"change": {
					"actions": ["create"],
					"after": {
						"acl": "private",
						"bucket": "mybucket",
						"bucket_prefix": null,
						"cors_rule": [],
						"force_destroy": false,
						"grant": [],
						"lifecycle_rule": [],
						"logging": [],
						"policy": null,
						"replication_configuration": [],
						"server_side_encryption_configuration": [],
						"tags": {"Name": "My bucket"},
						"tags_all": {"Name": "My bucket"},
						"website": [],
					},
					"after_sensitive": {
						"cors_rule": [],
						"grant": [],
						"lifecycle_rule": [],
						"logging": [],
						"object_lock_configuration": [],
						"replication_configuration": [],
						"server_side_encryption_configuration": [],
						"tags": {},
						"tags_all": {},
						"versioning": [],
						"website": [],
					},
					"after_unknown": {
						"acceleration_status": true,
						"arn": true,
						"bucket_domain_name": true,
						"bucket_regional_domain_name": true,
						"cors_rule": [],
						"grant": [],
						"hosted_zone_id": true,
						"id": true,
						"lifecycle_rule": [],
						"logging": [],
						"object_lock_configuration": true,
						"object_lock_enabled": true,
						"region": true,
						"replication_configuration": [],
						"request_payer": true,
						"server_side_encryption_configuration": [],
						"tags": {},
						"tags_all": {},
						"versioning": true,
						"website": [],
						"website_domain": true,
						"website_endpoint": true,
					},
					"before": null,
					"before_sensitive": false,
				},
				"mode": "managed",
				"name": "b",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"type": "aws_s3_bucket",
			},
			{
				"address": "aws_s3_bucket_acl.b_acl",
				"change": {
					"actions": ["create"],
					"after": {
						"acl": "private",
						"expected_bucket_owner": null,
					},
					"after_sensitive": {"access_control_policy": []},
					"after_unknown": {
						"access_control_policy": true,
						"bucket": true,
						"id": true,
					},
					"before": null,
					"before_sensitive": false,
				},
				"mode": "managed",
				"name": "b_acl",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"type": "aws_s3_bucket_acl",
			},
		],
		"terraform_version": "1.2.5",
		"variables": {
			"region": {"value": "us-west-2"},
			"vpc_cidr": {"value": "178.0.0.0/16"},
		},
	}
}
