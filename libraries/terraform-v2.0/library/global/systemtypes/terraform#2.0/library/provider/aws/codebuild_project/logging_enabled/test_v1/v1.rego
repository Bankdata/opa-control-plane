package global.systemtypes["terraform:2.0"].library.provider.aws.codebuild_project.logging_enabled.test_v1

import data.global.systemtypes["terraform:2.0"].library.provider.aws.codebuild_project.logging_enabled.v1

# Ensuring the output which is list of error message contains only one error message which
# is for resource `bad_example` while the input contains good resource = example.
test_codebuild_s3_logs_bad {
	cloudwatch_logs_status := "ENABLED"
	s3_logs_status := "DISABLED"
	in := input_with_log_status(cloudwatch_logs_status, s3_logs_status)
	actual := v1.codebuild_project_logging_enabled_check with input as in
	count(actual) == 1
}

test_codebuild_cloudwatch_logs_bad {
	cloudwatch_logs_status := "DISABLED"
	s3_logs_status := "ENABLED"
	in := input_with_log_status(cloudwatch_logs_status, s3_logs_status)
	actual := v1.codebuild_project_logging_enabled_check with input as in
	count(actual) == 1
}

test_codebuild_project_logging_enabled_good {
	cloudwatch_logs_status := "ENABLED"
	s3_logs_status := "ENABLED"
	in := input_with_log_status(cloudwatch_logs_status, s3_logs_status)
	actual := v1.codebuild_project_logging_enabled_check with input as in
	count(actual) == 0
}

test_codebuild_project_logging_disabled_bad {
	cloudwatch_logs_status := "DISABLED"
	s3_logs_status := "DISABLED"
	in := input_with_log_status(cloudwatch_logs_status, s3_logs_status)
	actual := v1.codebuild_project_logging_enabled_check with input as in
	count(actual) == 2
}

test_codebuild_project_no_logging_enabled_bad {
	in := input_logs_config
	actual := v1.codebuild_project_logging_enabled_check with input as in
	count(actual) == 1
}

input_with_log_status(cloudwatch_logs_status, s3_logs_status) = x {
	x := {
		"format_version": "1.1",
		"terraform_version": "1.2.4",
		"variables": {"region": {"value": "us-west-2"}},
		"planned_values": {"root_module": {"resources": [
			{
				"address": "aws_codebuild_project.example",
				"mode": "managed",
				"type": "aws_codebuild_project",
				"name": "example",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 0,
				"values": {
					"artifacts": [{
						"artifact_identifier": null,
						"bucket_owner_access": null,
						"encryption_disabled": false,
						"location": null,
						"name": null,
						"namespace_type": null,
						"override_artifact_name": false,
						"packaging": null,
						"path": null,
						"type": "NO_ARTIFACTS",
					}],
					"badge_enabled": false,
					"build_batch_config": [],
					"build_timeout": 5,
					"cache": [],
					"concurrent_build_limit": null,
					"description": "test_codebuild_project",
					"environment": [{
						"certificate": null,
						"compute_type": "BUILD_GENERAL1_SMALL",
						"environment_variable": [],
						"image": "aws/codebuild/standard:1.0",
						"image_pull_credentials_type": "CODEBUILD",
						"privileged_mode": true,
						"registry_credential": [],
						"type": "LINUX_CONTAINER",
					}],
					"file_system_locations": [],
					"logs_config": [{
						"cloudwatch_logs": [{
							"group_name": "log-group",
							"status": cloudwatch_logs_status,
							"stream_name": "log-stream",
						}],
						"s3_logs": [{
							"bucket_owner_access": null,
							"encryption_disabled": false,
							"status": s3_logs_status,
						}],
					}],
					"name": "test-project",
					"project_visibility": "PRIVATE",
					"queued_timeout": 480,
					"resource_access_role": null,
					"secondary_artifacts": [],
					"secondary_source_version": [],
					"secondary_sources": [],
					"source": [{
						"auth": [],
						"build_status_config": [],
						"buildspec": null,
						"git_clone_depth": 1,
						"git_submodules_config": [{"fetch_submodules": true}],
						"insecure_ssl": null,
						"location": "https://github.com/mitchellh/packer.git",
						"report_build_status": null,
						"type": "GITHUB",
					}],
					"source_version": "master",
					"tags": {"Environment": "Test"},
					"tags_all": {"Environment": "Test"},
					"vpc_config": [],
				},
				"sensitive_values": {
					"artifacts": [{}],
					"build_batch_config": [],
					"cache": [],
					"environment": [{
						"environment_variable": [],
						"registry_credential": [],
					}],
					"file_system_locations": [],
					"logs_config": [{
						"cloudwatch_logs": [{}],
						"s3_logs": [{}],
					}],
					"secondary_artifacts": [],
					"secondary_source_version": [],
					"secondary_sources": [],
					"source": [{
						"auth": [],
						"build_status_config": [],
						"git_submodules_config": [{}],
					}],
					"tags": {},
					"tags_all": {},
					"vpc_config": [],
				},
			},
			{
				"address": "aws_iam_role.example",
				"mode": "managed",
				"type": "aws_iam_role",
				"name": "example",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 0,
				"values": {
					"assume_role_policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"codebuild.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n",
					"description": null,
					"force_detach_policies": false,
					"max_session_duration": 3600,
					"name": "example",
					"path": "/",
					"permissions_boundary": null,
					"tags": null,
				},
				"sensitive_values": {
					"inline_policy": [],
					"managed_policy_arns": [],
					"tags_all": {},
				},
			},
			{
				"address": "aws_iam_role_policy.example",
				"mode": "managed",
				"type": "aws_iam_role_policy",
				"name": "example",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 0,
				"values": {
					"name_prefix": null,
					"policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:DescribeDhcpOptions\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeVpcs\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n",
					"role": "example",
				},
				"sensitive_values": {},
			},
			{
				"address": "aws_s3_bucket.tf_s3",
				"mode": "managed",
				"type": "aws_s3_bucket",
				"name": "tf_s3",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 0,
				"values": {
					"acl": "private",
					"bucket_prefix": null,
					"cors_rule": [],
					"force_destroy": false,
					"grant": [],
					"lifecycle_rule": [],
					"logging": [],
					"policy": null,
					"replication_configuration": [],
					"server_side_encryption_configuration": [],
					"tags": {
						"Name": "My bucket",
						"Purpose": "Policy Library Development",
					},
					"tags_all": {
						"Name": "My bucket",
						"Purpose": "Policy Library Development",
					},
					"website": [],
				},
				"sensitive_values": {
					"cors_rule": [],
					"grant": [],
					"lifecycle_rule": [],
					"logging": [],
					"object_lock_configuration": [],
					"replication_configuration": [],
					"server_side_encryption_configuration": [],
					"tags": {},
					"tags_all": {},
					"versioning": [],
					"website": [],
				},
			},
			{
				"address": "aws_s3_bucket_acl.tf_s3_acl",
				"mode": "managed",
				"type": "aws_s3_bucket_acl",
				"name": "tf_s3_acl",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 0,
				"values": {
					"acl": "private",
					"expected_bucket_owner": null,
				},
				"sensitive_values": {"access_control_policy": []},
			},
			{
				"address": "random_string.random_val",
				"mode": "managed",
				"type": "random_string",
				"name": "random_val",
				"provider_name": "registry.terraform.io/hashicorp/random",
				"schema_version": 2,
				"values": {
					"keepers": null,
					"length": 4,
					"lower": true,
					"min_lower": 0,
					"min_numeric": 0,
					"min_special": 0,
					"min_upper": 0,
					"number": true,
					"numeric": true,
					"override_special": ".-",
					"special": true,
					"upper": false,
				},
				"sensitive_values": {},
			},
		]}},
		"resource_changes": [
			{
				"address": "aws_codebuild_project.example",
				"mode": "managed",
				"type": "aws_codebuild_project",
				"name": "example",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"artifacts": [{
							"artifact_identifier": null,
							"bucket_owner_access": null,
							"encryption_disabled": false,
							"location": null,
							"name": null,
							"namespace_type": null,
							"override_artifact_name": false,
							"packaging": null,
							"path": null,
							"type": "NO_ARTIFACTS",
						}],
						"badge_enabled": false,
						"build_batch_config": [],
						"build_timeout": 5,
						"cache": [],
						"concurrent_build_limit": null,
						"description": "test_codebuild_project",
						"environment": [{
							"certificate": null,
							"compute_type": "BUILD_GENERAL1_SMALL",
							"environment_variable": [],
							"image": "aws/codebuild/standard:1.0",
							"image_pull_credentials_type": "CODEBUILD",
							"privileged_mode": true,
							"registry_credential": [],
							"type": "LINUX_CONTAINER",
						}],
						"file_system_locations": [],
						"logs_config": [{
							"cloudwatch_logs": [{
								"group_name": "log-group",
								"status": cloudwatch_logs_status,
								"stream_name": "log-stream",
							}],
							"s3_logs": [{
								"bucket_owner_access": null,
								"encryption_disabled": false,
								"status": s3_logs_status,
							}],
						}],
						"name": "test-project",
						"project_visibility": "PRIVATE",
						"queued_timeout": 480,
						"resource_access_role": null,
						"secondary_artifacts": [],
						"secondary_source_version": [],
						"secondary_sources": [],
						"source": [{
							"auth": [],
							"build_status_config": [],
							"buildspec": null,
							"git_clone_depth": 1,
							"git_submodules_config": [{"fetch_submodules": true}],
							"insecure_ssl": null,
							"location": "https://github.com/mitchellh/packer.git",
							"report_build_status": null,
							"type": "GITHUB",
						}],
						"source_version": "master",
						"tags": {"Environment": "Test"},
						"tags_all": {"Environment": "Test"},
						"vpc_config": [],
					},
					"after_unknown": {
						"arn": true,
						"artifacts": [{}],
						"badge_url": true,
						"build_batch_config": [],
						"cache": [],
						"encryption_key": true,
						"environment": [{
							"environment_variable": [],
							"registry_credential": [],
						}],
						"file_system_locations": [],
						"id": true,
						"logs_config": [{
							"cloudwatch_logs": [{}],
							"s3_logs": [{"location": true}],
						}],
						"public_project_alias": true,
						"secondary_artifacts": [],
						"secondary_source_version": [],
						"secondary_sources": [],
						"service_role": true,
						"source": [{
							"auth": [],
							"build_status_config": [],
							"git_submodules_config": [{}],
						}],
						"tags": {},
						"tags_all": {},
						"vpc_config": [],
					},
					"before_sensitive": false,
					"after_sensitive": {
						"artifacts": [{}],
						"build_batch_config": [],
						"cache": [],
						"environment": [{
							"environment_variable": [],
							"registry_credential": [],
						}],
						"file_system_locations": [],
						"logs_config": [{
							"cloudwatch_logs": [{}],
							"s3_logs": [{}],
						}],
						"secondary_artifacts": [],
						"secondary_source_version": [],
						"secondary_sources": [],
						"source": [{
							"auth": [],
							"build_status_config": [],
							"git_submodules_config": [{}],
						}],
						"tags": {},
						"tags_all": {},
						"vpc_config": [],
					},
				},
			},
			{
				"address": "aws_iam_role.example",
				"mode": "managed",
				"type": "aws_iam_role",
				"name": "example",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"assume_role_policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"codebuild.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n",
						"description": null,
						"force_detach_policies": false,
						"max_session_duration": 3600,
						"name": "example",
						"path": "/",
						"permissions_boundary": null,
						"tags": null,
					},
					"after_unknown": {
						"arn": true,
						"create_date": true,
						"id": true,
						"inline_policy": true,
						"managed_policy_arns": true,
						"name_prefix": true,
						"tags_all": true,
						"unique_id": true,
					},
					"before_sensitive": false,
					"after_sensitive": {
						"inline_policy": [],
						"managed_policy_arns": [],
						"tags_all": {},
					},
				},
			},
			{
				"address": "aws_iam_role_policy.example",
				"mode": "managed",
				"type": "aws_iam_role_policy",
				"name": "example",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"name_prefix": null,
						"policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:DescribeDhcpOptions\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeVpcs\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n",
						"role": "example",
					},
					"after_unknown": {
						"id": true,
						"name": true,
					},
					"before_sensitive": false,
					"after_sensitive": {},
				},
			},
			{
				"address": "aws_s3_bucket.tf_s3",
				"mode": "managed",
				"type": "aws_s3_bucket",
				"name": "tf_s3",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"acl": "private",
						"bucket_prefix": null,
						"cors_rule": [],
						"force_destroy": false,
						"grant": [],
						"lifecycle_rule": [],
						"logging": [],
						"policy": null,
						"replication_configuration": [],
						"server_side_encryption_configuration": [],
						"tags": {
							"Name": "My bucket",
							"Purpose": "Policy Library Development",
						},
						"tags_all": {
							"Name": "My bucket",
							"Purpose": "Policy Library Development",
						},
						"website": [],
					},
					"after_unknown": {
						"acceleration_status": true,
						"arn": true,
						"bucket": true,
						"bucket_domain_name": true,
						"bucket_regional_domain_name": true,
						"cors_rule": [],
						"grant": [],
						"hosted_zone_id": true,
						"id": true,
						"lifecycle_rule": [],
						"logging": [],
						"object_lock_configuration": true,
						"object_lock_enabled": true,
						"region": true,
						"replication_configuration": [],
						"request_payer": true,
						"server_side_encryption_configuration": [],
						"tags": {},
						"tags_all": {},
						"versioning": true,
						"website": [],
						"website_domain": true,
						"website_endpoint": true,
					},
					"before_sensitive": false,
					"after_sensitive": {
						"cors_rule": [],
						"grant": [],
						"lifecycle_rule": [],
						"logging": [],
						"object_lock_configuration": [],
						"replication_configuration": [],
						"server_side_encryption_configuration": [],
						"tags": {},
						"tags_all": {},
						"versioning": [],
						"website": [],
					},
				},
			},
			{
				"address": "aws_s3_bucket_acl.tf_s3_acl",
				"mode": "managed",
				"type": "aws_s3_bucket_acl",
				"name": "tf_s3_acl",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"acl": "private",
						"expected_bucket_owner": null,
					},
					"after_unknown": {
						"access_control_policy": true,
						"bucket": true,
						"id": true,
					},
					"before_sensitive": false,
					"after_sensitive": {"access_control_policy": []},
				},
			},
			{
				"address": "random_string.random_val",
				"mode": "managed",
				"type": "random_string",
				"name": "random_val",
				"provider_name": "registry.terraform.io/hashicorp/random",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"keepers": null,
						"length": 4,
						"lower": true,
						"min_lower": 0,
						"min_numeric": 0,
						"min_special": 0,
						"min_upper": 0,
						"number": true,
						"numeric": true,
						"override_special": ".-",
						"special": true,
						"upper": false,
					},
					"after_unknown": {
						"id": true,
						"result": true,
					},
					"before_sensitive": false,
					"after_sensitive": {},
				},
			},
		],
		"configuration": {
			"provider_config": {
				"aws": {
					"name": "aws",
					"full_name": "registry.terraform.io/hashicorp/aws",
					"version_constraint": "~> 3.27",
					"expressions": {
						"profile": {"constant_value": "default"},
						"region": {"references": ["var.region"]},
					},
				},
				"random": {
					"name": "random",
					"full_name": "registry.terraform.io/hashicorp/random",
				},
			},
			"root_module": {
				"resources": [
					{
						"address": "aws_codebuild_project.example",
						"mode": "managed",
						"type": "aws_codebuild_project",
						"name": "example",
						"provider_config_key": "aws",
						"expressions": {
							"artifacts": [{"type": {"constant_value": "NO_ARTIFACTS"}}],
							"build_timeout": {"constant_value": "5"},
							"description": {"constant_value": "test_codebuild_project"},
							"environment": [{
								"compute_type": {"constant_value": "BUILD_GENERAL1_SMALL"},
								"image": {"constant_value": "aws/codebuild/standard:1.0"},
								"image_pull_credentials_type": {"constant_value": "CODEBUILD"},
								"privileged_mode": {"constant_value": true},
								"type": {"constant_value": "LINUX_CONTAINER"},
							}],
							"logs_config": [{
								"cloudwatch_logs": [{
									"group_name": {"constant_value": "log-group"},
									"stream_name": {"constant_value": "log-stream"},
								}],
								"s3_logs": [{
									"location": {"references": [
										"aws_s3_bucket.tf_s3.id",
										"aws_s3_bucket.tf_s3",
									]},
									"status": {"constant_value": "ENABLED"},
								}],
							}],
							"name": {"constant_value": "test-project"},
							"service_role": {"references": [
								"aws_iam_role.example.arn",
								"aws_iam_role.example",
							]},
							"source": [{
								"git_clone_depth": {"constant_value": 1},
								"git_submodules_config": [{"fetch_submodules": {"constant_value": true}}],
								"location": {"constant_value": "https://github.com/mitchellh/packer.git"},
								"type": {"constant_value": "GITHUB"},
							}],
							"source_version": {"constant_value": "master"},
							"tags": {"constant_value": {"Environment": "Test"}},
						},
						"schema_version": 0,
					},
					{
						"address": "aws_iam_role.example",
						"mode": "managed",
						"type": "aws_iam_role",
						"name": "example",
						"provider_config_key": "aws",
						"expressions": {
							"assume_role_policy": {"constant_value": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"codebuild.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n"},
							"name": {"constant_value": "example"},
						},
						"schema_version": 0,
					},
					{
						"address": "aws_iam_role_policy.example",
						"mode": "managed",
						"type": "aws_iam_role_policy",
						"name": "example",
						"provider_config_key": "aws",
						"expressions": {
							"policy": {"constant_value": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:DescribeDhcpOptions\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeVpcs\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n"},
							"role": {"references": [
								"aws_iam_role.example.name",
								"aws_iam_role.example",
							]},
						},
						"schema_version": 0,
					},
					{
						"address": "aws_s3_bucket.tf_s3",
						"mode": "managed",
						"type": "aws_s3_bucket",
						"name": "tf_s3",
						"provider_config_key": "aws",
						"expressions": {
							"bucket": {"references": ["local.bucket_name"]},
							"tags": {"constant_value": {
								"Name": "My bucket",
								"Purpose": "Policy Library Development",
							}},
						},
						"schema_version": 0,
					},
					{
						"address": "aws_s3_bucket_acl.tf_s3_acl",
						"mode": "managed",
						"type": "aws_s3_bucket_acl",
						"name": "tf_s3_acl",
						"provider_config_key": "aws",
						"expressions": {
							"acl": {"constant_value": "private"},
							"bucket": {"references": [
								"aws_s3_bucket.tf_s3.id",
								"aws_s3_bucket.tf_s3",
							]},
						},
						"schema_version": 0,
					},
					{
						"address": "random_string.random_val",
						"mode": "managed",
						"type": "random_string",
						"name": "random_val",
						"provider_config_key": "random",
						"expressions": {
							"length": {"constant_value": 4},
							"override_special": {"constant_value": ".-"},
							"special": {"constant_value": true},
							"upper": {"constant_value": false},
						},
						"schema_version": 2,
					},
				],
				"variables": {"region": {"default": "us-west-2"}},
			},
		},
		"relevant_attributes": [
			{
				"resource": "aws_iam_role.example",
				"attribute": ["arn"],
			},
			{
				"resource": "random_string.random_val",
				"attribute": ["result"],
			},
			{
				"resource": "aws_iam_role.example",
				"attribute": ["name"],
			},
			{
				"resource": "aws_s3_bucket.tf_s3",
				"attribute": ["id"],
			},
		],
	}
}

input_logs_config = x {
	x := {
		"format_version": "1.1",
		"terraform_version": "1.2.2",
		"variables": {"region": {"value": "us-west-2"}},
		"planned_values": {
			"outputs": {"codebuild_id": {"sensitive": false}},
			"root_module": {"resources": [
				{
					"address": "aws_codebuild_project.example",
					"mode": "managed",
					"type": "aws_codebuild_project",
					"name": "example",
					"provider_name": "registry.terraform.io/hashicorp/aws",
					"schema_version": 0,
					"values": {
						"artifacts": [{
							"artifact_identifier": null,
							"bucket_owner_access": null,
							"encryption_disabled": false,
							"location": null,
							"name": null,
							"namespace_type": null,
							"override_artifact_name": false,
							"packaging": null,
							"path": null,
							"type": "NO_ARTIFACTS",
						}],
						"badge_enabled": false,
						"build_batch_config": [],
						"build_timeout": 5,
						"cache": [],
						"concurrent_build_limit": null,
						"description": "test_codebuild_project",
						"environment": [{
							"certificate": null,
							"compute_type": "BUILD_GENERAL1_SMALL",
							"environment_variable": [],
							"image": "aws/codebuild/standard:1.0",
							"image_pull_credentials_type": "CODEBUILD",
							"privileged_mode": true,
							"registry_credential": [],
							"type": "LINUX_CONTAINER",
						}],
						"file_system_locations": [],
						"logs_config": [],
						"name": "test-project",
						"project_visibility": "PRIVATE",
						"queued_timeout": 480,
						"resource_access_role": null,
						"secondary_artifacts": [],
						"secondary_source_version": [],
						"secondary_sources": [],
						"source": [{
							"auth": [],
							"build_status_config": [],
							"buildspec": null,
							"git_clone_depth": 1,
							"git_submodules_config": [{"fetch_submodules": true}],
							"insecure_ssl": null,
							"location": "https://github.com/mitchellh/packer.git",
							"report_build_status": null,
							"type": "GITHUB",
						}],
						"source_version": "master",
						"tags": {"Environment": "Test"},
						"tags_all": {"Environment": "Test"},
						"vpc_config": [],
					},
					"sensitive_values": {
						"artifacts": [{}],
						"build_batch_config": [],
						"cache": [],
						"environment": [{
							"environment_variable": [],
							"registry_credential": [],
						}],
						"file_system_locations": [],
						"logs_config": [],
						"secondary_artifacts": [],
						"secondary_source_version": [],
						"secondary_sources": [],
						"source": [{
							"auth": [],
							"build_status_config": [],
							"git_submodules_config": [{}],
						}],
						"tags": {},
						"tags_all": {},
						"vpc_config": [],
					},
				},
				{
					"address": "aws_iam_role.example",
					"mode": "managed",
					"type": "aws_iam_role",
					"name": "example",
					"provider_name": "registry.terraform.io/hashicorp/aws",
					"schema_version": 0,
					"values": {
						"assume_role_policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"codebuild.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n",
						"description": null,
						"force_detach_policies": false,
						"max_session_duration": 3600,
						"name": "example",
						"path": "/",
						"permissions_boundary": null,
						"tags": null,
					},
					"sensitive_values": {
						"inline_policy": [],
						"managed_policy_arns": [],
						"tags_all": {},
					},
				},
				{
					"address": "aws_iam_role_policy.example",
					"mode": "managed",
					"type": "aws_iam_role_policy",
					"name": "example",
					"provider_name": "registry.terraform.io/hashicorp/aws",
					"schema_version": 0,
					"values": {
						"name_prefix": null,
						"policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:DescribeDhcpOptions\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeVpcs\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n",
						"role": "example",
					},
					"sensitive_values": {},
				},
			]},
		},
		"resource_changes": [
			{
				"address": "aws_codebuild_project.example",
				"mode": "managed",
				"type": "aws_codebuild_project",
				"name": "example",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"artifacts": [{
							"artifact_identifier": null,
							"bucket_owner_access": null,
							"encryption_disabled": false,
							"location": null,
							"name": null,
							"namespace_type": null,
							"override_artifact_name": false,
							"packaging": null,
							"path": null,
							"type": "NO_ARTIFACTS",
						}],
						"badge_enabled": false,
						"build_batch_config": [],
						"build_timeout": 5,
						"cache": [],
						"concurrent_build_limit": null,
						"description": "test_codebuild_project",
						"environment": [{
							"certificate": null,
							"compute_type": "BUILD_GENERAL1_SMALL",
							"environment_variable": [],
							"image": "aws/codebuild/standard:1.0",
							"image_pull_credentials_type": "CODEBUILD",
							"privileged_mode": true,
							"registry_credential": [],
							"type": "LINUX_CONTAINER",
						}],
						"file_system_locations": [],
						"logs_config": [],
						"name": "test-project",
						"project_visibility": "PRIVATE",
						"queued_timeout": 480,
						"resource_access_role": null,
						"secondary_artifacts": [],
						"secondary_source_version": [],
						"secondary_sources": [],
						"source": [{
							"auth": [],
							"build_status_config": [],
							"buildspec": null,
							"git_clone_depth": 1,
							"git_submodules_config": [{"fetch_submodules": true}],
							"insecure_ssl": null,
							"location": "https://github.com/mitchellh/packer.git",
							"report_build_status": null,
							"type": "GITHUB",
						}],
						"source_version": "master",
						"tags": {"Environment": "Test"},
						"tags_all": {"Environment": "Test"},
						"vpc_config": [],
					},
					"after_unknown": {
						"arn": true,
						"artifacts": [{}],
						"badge_url": true,
						"build_batch_config": [],
						"cache": [],
						"encryption_key": true,
						"environment": [{
							"environment_variable": [],
							"registry_credential": [],
						}],
						"file_system_locations": [],
						"id": true,
						"logs_config": [],
						"public_project_alias": true,
						"secondary_artifacts": [],
						"secondary_source_version": [],
						"secondary_sources": [],
						"service_role": true,
						"source": [{
							"auth": [],
							"build_status_config": [],
							"git_submodules_config": [{}],
						}],
						"tags": {},
						"tags_all": {},
						"vpc_config": [],
					},
					"before_sensitive": false,
					"after_sensitive": {
						"artifacts": [{}],
						"build_batch_config": [],
						"cache": [],
						"environment": [{
							"environment_variable": [],
							"registry_credential": [],
						}],
						"file_system_locations": [],
						"logs_config": [],
						"secondary_artifacts": [],
						"secondary_source_version": [],
						"secondary_sources": [],
						"source": [{
							"auth": [],
							"build_status_config": [],
							"git_submodules_config": [{}],
						}],
						"tags": {},
						"tags_all": {},
						"vpc_config": [],
					},
				},
			},
			{
				"address": "aws_iam_role.example",
				"mode": "managed",
				"type": "aws_iam_role",
				"name": "example",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"assume_role_policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"codebuild.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n",
						"description": null,
						"force_detach_policies": false,
						"max_session_duration": 3600,
						"name": "example",
						"path": "/",
						"permissions_boundary": null,
						"tags": null,
					},
					"after_unknown": {
						"arn": true,
						"create_date": true,
						"id": true,
						"inline_policy": true,
						"managed_policy_arns": true,
						"name_prefix": true,
						"tags_all": true,
						"unique_id": true,
					},
					"before_sensitive": false,
					"after_sensitive": {
						"inline_policy": [],
						"managed_policy_arns": [],
						"tags_all": {},
					},
				},
			},
			{
				"address": "aws_iam_role_policy.example",
				"mode": "managed",
				"type": "aws_iam_role_policy",
				"name": "example",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"name_prefix": null,
						"policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:DescribeDhcpOptions\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeVpcs\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n",
						"role": "example",
					},
					"after_unknown": {
						"id": true,
						"name": true,
					},
					"before_sensitive": false,
					"after_sensitive": {},
				},
			},
		],
		"output_changes": {"codebuild_id": {
			"actions": ["create"],
			"before": null,
			"after_unknown": true,
			"before_sensitive": false,
			"after_sensitive": false,
		}},
		"configuration": {
			"provider_config": {"aws": {
				"name": "aws",
				"full_name": "registry.terraform.io/hashicorp/aws",
				"version_constraint": "~> 3.27",
				"expressions": {
					"profile": {"constant_value": "default"},
					"region": {"references": ["var.region"]},
				},
			}},
			"root_module": {
				"outputs": {"codebuild_id": {"expression": {"references": [
					"aws_codebuild_project.example.id",
					"aws_codebuild_project.example",
				]}}},
				"resources": [
					{
						"address": "aws_codebuild_project.example",
						"mode": "managed",
						"type": "aws_codebuild_project",
						"name": "example",
						"provider_config_key": "aws",
						"expressions": {
							"artifacts": [{"type": {"constant_value": "NO_ARTIFACTS"}}],
							"build_timeout": {"constant_value": "5"},
							"description": {"constant_value": "test_codebuild_project"},
							"environment": [{
								"compute_type": {"constant_value": "BUILD_GENERAL1_SMALL"},
								"image": {"constant_value": "aws/codebuild/standard:1.0"},
								"image_pull_credentials_type": {"constant_value": "CODEBUILD"},
								"privileged_mode": {"constant_value": true},
								"type": {"constant_value": "LINUX_CONTAINER"},
							}],
							"name": {"constant_value": "test-project"},
							"service_role": {"references": [
								"aws_iam_role.example.arn",
								"aws_iam_role.example",
							]},
							"source": [{
								"git_clone_depth": {"constant_value": 1},
								"git_submodules_config": [{"fetch_submodules": {"constant_value": true}}],
								"location": {"constant_value": "https://github.com/mitchellh/packer.git"},
								"type": {"constant_value": "GITHUB"},
							}],
							"source_version": {"constant_value": "master"},
							"tags": {"constant_value": {"Environment": "Test"}},
						},
						"schema_version": 0,
					},
					{
						"address": "aws_iam_role.example",
						"mode": "managed",
						"type": "aws_iam_role",
						"name": "example",
						"provider_config_key": "aws",
						"expressions": {
							"assume_role_policy": {"constant_value": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"codebuild.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n"},
							"name": {"constant_value": "example"},
						},
						"schema_version": 0,
					},
					{
						"address": "aws_iam_role_policy.example",
						"mode": "managed",
						"type": "aws_iam_role_policy",
						"name": "example",
						"provider_config_key": "aws",
						"expressions": {
							"policy": {"constant_value": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:DescribeDhcpOptions\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeVpcs\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n"},
							"role": {"references": [
								"aws_iam_role.example.name",
								"aws_iam_role.example",
							]},
						},
						"schema_version": 0,
					},
				],
				"variables": {"region": {"default": "us-west-2"}},
			},
		},
		"relevant_attributes": [
			{
				"resource": "aws_iam_role.example",
				"attribute": ["name"],
			},
			{
				"resource": "aws_iam_role.example",
				"attribute": ["arn"],
			},
			{
				"resource": "aws_codebuild_project.example",
				"attribute": ["id"],
			},
		],
	}
}
