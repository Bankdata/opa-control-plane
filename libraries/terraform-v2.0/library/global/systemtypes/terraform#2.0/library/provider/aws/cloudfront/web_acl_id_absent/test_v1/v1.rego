package global.systemtypes["terraform:2.0"].library.provider.aws.cloudfront.web_acl_id_absent.test_v1

import data.global.systemtypes["terraform:2.0"].library.provider.aws.cloudfront.web_acl_id_absent.v1

test_web_acl_id_absent_good {
	web_acl_id := "arn:aws:wafv2:us-east-1:111122223333:regional/webacl/*/*"
	in := input_cloudfront_distribution(web_acl_id)
	actual := v1.prohibit_cloudfront_distribution_without_web_acl_id with input as in
	count(actual) == 0
}

test_web_acl_id_null_bad {
	web_acl_id := null
	in := input_cloudfront_distribution(web_acl_id)
	actual := v1.prohibit_cloudfront_distribution_without_web_acl_id with input as in
	count(actual) == 1
}

test_web_acl_id_absent_bad {
	in := input_cloudfront_distribution_without_web_acl_id
	actual := v1.prohibit_cloudfront_distribution_without_web_acl_id with input as in
	count(actual) == 1
}

input_cloudfront_distribution_without_web_acl_id := x {
	x := {
		"format_version": "1.1",
		"terraform_version": "1.2.5",
		"variables": {
			"region": {"value": "us-west-2"},
			"vpc_cidr": {"value": "178.0.0.0/16"},
		},
		"planned_values": {"root_module": {"resources": [
			{
				"address": "aws_cloudfront_distribution.s3_distribution",
				"mode": "managed",
				"type": "aws_cloudfront_distribution",
				"name": "s3_distribution",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 1,
				"values": {
					"aliases": null,
					"comment": null,
					"custom_error_response": [],
					"default_cache_behavior": [{
						"allowed_methods": [
							"DELETE",
							"GET",
							"HEAD",
							"OPTIONS",
							"PATCH",
							"POST",
							"PUT",
						],
						"cache_policy_id": null,
						"cached_methods": [
							"GET",
							"HEAD",
						],
						"compress": false,
						"default_ttl": 3600,
						"field_level_encryption_id": null,
						"forwarded_values": [{
							"cookies": [{"forward": "none"}],
							"query_string": false,
						}],
						"function_association": [],
						"lambda_function_association": [],
						"max_ttl": 86400,
						"min_ttl": 0,
						"origin_request_policy_id": null,
						"realtime_log_config_arn": null,
						"response_headers_policy_id": null,
						"smooth_streaming": null,
						"target_origin_id": "myS3Origin",
						"viewer_protocol_policy": "allow-all",
					}],
					"default_root_object": null,
					"enabled": true,
					"http_version": "http2",
					"is_ipv6_enabled": false,
					"logging_config": [],
					"ordered_cache_behavior": [],
					"origin": [{
						"connection_attempts": 3,
						"connection_timeout": 10,
						"custom_header": [],
						"custom_origin_config": [],
						"origin_id": "myS3Origin",
						"origin_path": "",
						"origin_shield": [],
						"s3_origin_config": [{}],
					}],
					"origin_group": [],
					"price_class": "PriceClass_200",
					"restrictions": [{"geo_restriction": [{
						"locations": [
							"CA",
							"DE",
							"GB",
							"US",
						],
						"restriction_type": "whitelist",
					}]}],
					"retain_on_delete": false,
					"tags": {"Environment": "dev"},
					"tags_all": {"Environment": "dev"},
					"viewer_certificate": [{
						"acm_certificate_arn": null,
						"cloudfront_default_certificate": true,
						"iam_certificate_id": null,
						"minimum_protocol_version": "TLSv1",
						"ssl_support_method": null,
					}],
					"wait_for_deployment": true,
				},
				"sensitive_values": {
					"custom_error_response": [],
					"default_cache_behavior": [{
						"allowed_methods": [
							false,
							false,
							false,
							false,
							false,
							false,
							false,
						],
						"cached_methods": [
							false,
							false,
						],
						"forwarded_values": [{
							"cookies": [{"whitelisted_names": []}],
							"headers": [],
							"query_string_cache_keys": [],
						}],
						"function_association": [],
						"lambda_function_association": [],
						"trusted_key_groups": [],
						"trusted_signers": [],
					}],
					"logging_config": [],
					"ordered_cache_behavior": [],
					"origin": [{
						"custom_header": [],
						"custom_origin_config": [],
						"origin_shield": [],
						"s3_origin_config": [{}],
					}],
					"origin_group": [],
					"restrictions": [{"geo_restriction": [{"locations": [
						false,
						false,
						false,
						false,
					]}]}],
					"tags": {},
					"tags_all": {},
					"trusted_key_groups": [],
					"trusted_signers": [],
					"viewer_certificate": [{}],
				},
			},
			{
				"address": "aws_cloudfront_origin_access_identity.cdn_origin_access_identity",
				"mode": "managed",
				"type": "aws_cloudfront_origin_access_identity",
				"name": "cdn_origin_access_identity",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 0,
				"values": {"comment": "aws_cloudfront_origin_access_identity"},
				"sensitive_values": {},
			},
			{
				"address": "aws_route53_zone.tf_sample_r53",
				"mode": "managed",
				"type": "aws_route53_zone",
				"name": "tf_sample_r53",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 0,
				"values": {
					"comment": "Managed by Terraform",
					"delegation_set_id": null,
					"force_destroy": false,
					"name": "tfsampler53.com",
					"tags": null,
					"vpc": [{}],
				},
				"sensitive_values": {
					"name_servers": [],
					"tags_all": {},
					"vpc": [{}],
				},
			},
			{
				"address": "aws_s3_bucket.tf_sample_s3",
				"mode": "managed",
				"type": "aws_s3_bucket",
				"name": "tf_sample_s3",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 0,
				"values": {
					"acl": "private",
					"bucket_prefix": null,
					"cors_rule": [],
					"force_destroy": false,
					"grant": [],
					"lifecycle_rule": [],
					"logging": [],
					"policy": null,
					"replication_configuration": [],
					"server_side_encryption_configuration": [],
					"tags": {
						"Name": "My bucket",
						"Purpose": "Policy Library Development",
					},
					"tags_all": {
						"Name": "My bucket",
						"Purpose": "Policy Library Development",
					},
					"website": [],
				},
				"sensitive_values": {
					"cors_rule": [],
					"grant": [],
					"lifecycle_rule": [],
					"logging": [],
					"object_lock_configuration": [],
					"replication_configuration": [],
					"server_side_encryption_configuration": [],
					"tags": {},
					"tags_all": {},
					"versioning": [],
					"website": [],
				},
			},
			{
				"address": "aws_vpc.tf_sample_vpc",
				"mode": "managed",
				"type": "aws_vpc",
				"name": "tf_sample_vpc",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 1,
				"values": {
					"assign_generated_ipv6_cidr_block": null,
					"cidr_block": "178.0.0.0/16",
					"enable_dns_support": true,
					"instance_tenancy": "default",
					"ipv4_ipam_pool_id": null,
					"ipv4_netmask_length": null,
					"ipv6_ipam_pool_id": null,
					"ipv6_netmask_length": null,
					"tags": {"Name": "tf_sample_vpc"},
					"tags_all": {"Name": "tf_sample_vpc"},
				},
				"sensitive_values": {
					"tags": {},
					"tags_all": {},
				},
			},
			{
				"address": "random_string.random_val",
				"mode": "managed",
				"type": "random_string",
				"name": "random_val",
				"provider_name": "registry.terraform.io/hashicorp/random",
				"schema_version": 2,
				"values": {
					"keepers": null,
					"length": 4,
					"lower": true,
					"min_lower": 0,
					"min_numeric": 0,
					"min_special": 0,
					"min_upper": 0,
					"number": true,
					"numeric": true,
					"override_special": ".-",
					"special": true,
					"upper": false,
				},
				"sensitive_values": {},
			},
		]}},
		"resource_changes": [
			{
				"address": "aws_cloudfront_distribution.s3_distribution",
				"mode": "managed",
				"type": "aws_cloudfront_distribution",
				"name": "s3_distribution",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"aliases": null,
						"comment": null,
						"custom_error_response": [],
						"default_cache_behavior": [{
							"allowed_methods": [
								"DELETE",
								"GET",
								"HEAD",
								"OPTIONS",
								"PATCH",
								"POST",
								"PUT",
							],
							"cache_policy_id": null,
							"cached_methods": [
								"GET",
								"HEAD",
							],
							"compress": false,
							"default_ttl": 3600,
							"field_level_encryption_id": null,
							"forwarded_values": [{
								"cookies": [{"forward": "none"}],
								"query_string": false,
							}],
							"function_association": [],
							"lambda_function_association": [],
							"max_ttl": 86400,
							"min_ttl": 0,
							"origin_request_policy_id": null,
							"realtime_log_config_arn": null,
							"response_headers_policy_id": null,
							"smooth_streaming": null,
							"target_origin_id": "myS3Origin",
							"viewer_protocol_policy": "allow-all",
						}],
						"default_root_object": null,
						"enabled": true,
						"http_version": "http2",
						"is_ipv6_enabled": false,
						"logging_config": [],
						"ordered_cache_behavior": [],
						"origin": [{
							"connection_attempts": 3,
							"connection_timeout": 10,
							"custom_header": [],
							"custom_origin_config": [],
							"origin_id": "myS3Origin",
							"origin_path": "",
							"origin_shield": [],
							"s3_origin_config": [{}],
						}],
						"origin_group": [],
						"price_class": "PriceClass_200",
						"restrictions": [{"geo_restriction": [{
							"locations": [
								"CA",
								"DE",
								"GB",
								"US",
							],
							"restriction_type": "whitelist",
						}]}],
						"retain_on_delete": false,
						"tags": {"Environment": "dev"},
						"tags_all": {"Environment": "dev"},
						"viewer_certificate": [{
							"acm_certificate_arn": null,
							"cloudfront_default_certificate": true,
							"iam_certificate_id": null,
							"minimum_protocol_version": "TLSv1",
							"ssl_support_method": null,
						}],
						"wait_for_deployment": true,
					},
					"after_unknown": {
						"arn": true,
						"caller_reference": true,
						"custom_error_response": [],
						"default_cache_behavior": [{
							"allowed_methods": [
								false,
								false,
								false,
								false,
								false,
								false,
								false,
							],
							"cached_methods": [
								false,
								false,
							],
							"forwarded_values": [{
								"cookies": [{"whitelisted_names": true}],
								"headers": true,
								"query_string_cache_keys": true,
							}],
							"function_association": [],
							"lambda_function_association": [],
							"trusted_key_groups": true,
							"trusted_signers": true,
						}],
						"domain_name": true,
						"etag": true,
						"hosted_zone_id": true,
						"id": true,
						"in_progress_validation_batches": true,
						"last_modified_time": true,
						"logging_config": [],
						"ordered_cache_behavior": [],
						"origin": [{
							"custom_header": [],
							"custom_origin_config": [],
							"domain_name": true,
							"origin_shield": [],
							"s3_origin_config": [{"origin_access_identity": true}],
						}],
						"origin_group": [],
						"restrictions": [{"geo_restriction": [{"locations": [
							false,
							false,
							false,
							false,
						]}]}],
						"status": true,
						"tags": {},
						"tags_all": {},
						"trusted_key_groups": true,
						"trusted_signers": true,
						"viewer_certificate": [{}],
					},
					"before_sensitive": false,
					"after_sensitive": {
						"custom_error_response": [],
						"default_cache_behavior": [{
							"allowed_methods": [
								false,
								false,
								false,
								false,
								false,
								false,
								false,
							],
							"cached_methods": [
								false,
								false,
							],
							"forwarded_values": [{
								"cookies": [{"whitelisted_names": []}],
								"headers": [],
								"query_string_cache_keys": [],
							}],
							"function_association": [],
							"lambda_function_association": [],
							"trusted_key_groups": [],
							"trusted_signers": [],
						}],
						"logging_config": [],
						"ordered_cache_behavior": [],
						"origin": [{
							"custom_header": [],
							"custom_origin_config": [],
							"origin_shield": [],
							"s3_origin_config": [{}],
						}],
						"origin_group": [],
						"restrictions": [{"geo_restriction": [{"locations": [
							false,
							false,
							false,
							false,
						]}]}],
						"tags": {},
						"tags_all": {},
						"trusted_key_groups": [],
						"trusted_signers": [],
						"viewer_certificate": [{}],
					},
				},
			},
			{
				"address": "aws_cloudfront_origin_access_identity.cdn_origin_access_identity",
				"mode": "managed",
				"type": "aws_cloudfront_origin_access_identity",
				"name": "cdn_origin_access_identity",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {"comment": "aws_cloudfront_origin_access_identity"},
					"after_unknown": {
						"caller_reference": true,
						"cloudfront_access_identity_path": true,
						"etag": true,
						"iam_arn": true,
						"id": true,
						"s3_canonical_user_id": true,
					},
					"before_sensitive": false,
					"after_sensitive": {},
				},
			},
			{
				"address": "aws_route53_zone.tf_sample_r53",
				"mode": "managed",
				"type": "aws_route53_zone",
				"name": "tf_sample_r53",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"comment": "Managed by Terraform",
						"delegation_set_id": null,
						"force_destroy": false,
						"name": "tfsampler53.com",
						"tags": null,
						"vpc": [{}],
					},
					"after_unknown": {
						"arn": true,
						"id": true,
						"name_servers": true,
						"tags_all": true,
						"vpc": [{
							"vpc_id": true,
							"vpc_region": true,
						}],
						"zone_id": true,
					},
					"before_sensitive": false,
					"after_sensitive": {
						"name_servers": [],
						"tags_all": {},
						"vpc": [{}],
					},
				},
			},
			{
				"address": "aws_s3_bucket.tf_sample_s3",
				"mode": "managed",
				"type": "aws_s3_bucket",
				"name": "tf_sample_s3",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"acl": "private",
						"bucket_prefix": null,
						"cors_rule": [],
						"force_destroy": false,
						"grant": [],
						"lifecycle_rule": [],
						"logging": [],
						"policy": null,
						"replication_configuration": [],
						"server_side_encryption_configuration": [],
						"tags": {
							"Name": "My bucket",
							"Purpose": "Policy Library Development",
						},
						"tags_all": {
							"Name": "My bucket",
							"Purpose": "Policy Library Development",
						},
						"website": [],
					},
					"after_unknown": {
						"acceleration_status": true,
						"arn": true,
						"bucket": true,
						"bucket_domain_name": true,
						"bucket_regional_domain_name": true,
						"cors_rule": [],
						"grant": [],
						"hosted_zone_id": true,
						"id": true,
						"lifecycle_rule": [],
						"logging": [],
						"object_lock_configuration": true,
						"object_lock_enabled": true,
						"region": true,
						"replication_configuration": [],
						"request_payer": true,
						"server_side_encryption_configuration": [],
						"tags": {},
						"tags_all": {},
						"versioning": true,
						"website": [],
						"website_domain": true,
						"website_endpoint": true,
					},
					"before_sensitive": false,
					"after_sensitive": {
						"cors_rule": [],
						"grant": [],
						"lifecycle_rule": [],
						"logging": [],
						"object_lock_configuration": [],
						"replication_configuration": [],
						"server_side_encryption_configuration": [],
						"tags": {},
						"tags_all": {},
						"versioning": [],
						"website": [],
					},
				},
			},
			{
				"address": "aws_vpc.tf_sample_vpc",
				"mode": "managed",
				"type": "aws_vpc",
				"name": "tf_sample_vpc",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"assign_generated_ipv6_cidr_block": null,
						"cidr_block": "178.0.0.0/16",
						"enable_dns_support": true,
						"instance_tenancy": "default",
						"ipv4_ipam_pool_id": null,
						"ipv4_netmask_length": null,
						"ipv6_ipam_pool_id": null,
						"ipv6_netmask_length": null,
						"tags": {"Name": "tf_sample_vpc"},
						"tags_all": {"Name": "tf_sample_vpc"},
					},
					"after_unknown": {
						"arn": true,
						"default_network_acl_id": true,
						"default_route_table_id": true,
						"default_security_group_id": true,
						"dhcp_options_id": true,
						"enable_classiclink": true,
						"enable_classiclink_dns_support": true,
						"enable_dns_hostnames": true,
						"id": true,
						"ipv6_association_id": true,
						"ipv6_cidr_block": true,
						"ipv6_cidr_block_network_border_group": true,
						"main_route_table_id": true,
						"owner_id": true,
						"tags": {},
						"tags_all": {},
					},
					"before_sensitive": false,
					"after_sensitive": {
						"tags": {},
						"tags_all": {},
					},
				},
			},
			{
				"address": "random_string.random_val",
				"mode": "managed",
				"type": "random_string",
				"name": "random_val",
				"provider_name": "registry.terraform.io/hashicorp/random",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"keepers": null,
						"length": 4,
						"lower": true,
						"min_lower": 0,
						"min_numeric": 0,
						"min_special": 0,
						"min_upper": 0,
						"number": true,
						"numeric": true,
						"override_special": ".-",
						"special": true,
						"upper": false,
					},
					"after_unknown": {
						"id": true,
						"result": true,
					},
					"before_sensitive": false,
					"after_sensitive": {},
				},
			},
		],
		"configuration": {
			"provider_config": {
				"aws": {
					"name": "aws",
					"full_name": "registry.terraform.io/hashicorp/aws",
					"version_constraint": "~> 3.27",
					"expressions": {
						"profile": {"constant_value": "default"},
						"region": {"references": ["var.region"]},
					},
				},
				"random": {
					"name": "random",
					"full_name": "registry.terraform.io/hashicorp/random",
				},
			},
			"root_module": {
				"resources": [
					{
						"address": "aws_cloudfront_distribution.s3_distribution",
						"mode": "managed",
						"type": "aws_cloudfront_distribution",
						"name": "s3_distribution",
						"provider_config_key": "aws",
						"expressions": {
							"default_cache_behavior": [{
								"allowed_methods": {"constant_value": [
									"DELETE",
									"GET",
									"HEAD",
									"OPTIONS",
									"PATCH",
									"POST",
									"PUT",
								]},
								"cached_methods": {"constant_value": [
									"GET",
									"HEAD",
								]},
								"default_ttl": {"constant_value": 3600},
								"forwarded_values": [{
									"cookies": [{"forward": {"constant_value": "none"}}],
									"query_string": {"constant_value": false},
								}],
								"max_ttl": {"constant_value": 86400},
								"min_ttl": {"constant_value": 0},
								"target_origin_id": {"references": ["local.s3_origin_id"]},
								"viewer_protocol_policy": {"constant_value": "allow-all"},
							}],
							"enabled": {"constant_value": true},
							"origin": [{
								"domain_name": {"references": [
									"aws_s3_bucket.tf_sample_s3.bucket_regional_domain_name",
									"aws_s3_bucket.tf_sample_s3",
								]},
								"origin_id": {"references": ["local.s3_origin_id"]},
								"s3_origin_config": [{"origin_access_identity": {"references": [
									"aws_cloudfront_origin_access_identity.cdn_origin_access_identity.cloudfront_access_identity_path",
									"aws_cloudfront_origin_access_identity.cdn_origin_access_identity",
								]}}],
							}],
							"price_class": {"constant_value": "PriceClass_200"},
							"restrictions": [{"geo_restriction": [{
								"locations": {"constant_value": [
									"US",
									"CA",
									"GB",
									"DE",
								]},
								"restriction_type": {"constant_value": "whitelist"},
							}]}],
							"tags": {"constant_value": {"Environment": "dev"}},
							"viewer_certificate": [{"cloudfront_default_certificate": {"constant_value": true}}],
						},
						"schema_version": 1,
					},
					{
						"address": "aws_cloudfront_origin_access_identity.cdn_origin_access_identity",
						"mode": "managed",
						"type": "aws_cloudfront_origin_access_identity",
						"name": "cdn_origin_access_identity",
						"provider_config_key": "aws",
						"expressions": {"comment": {"constant_value": "aws_cloudfront_origin_access_identity"}},
						"schema_version": 0,
					},
					{
						"address": "aws_route53_zone.tf_sample_r53",
						"mode": "managed",
						"type": "aws_route53_zone",
						"name": "tf_sample_r53",
						"provider_config_key": "aws",
						"expressions": {
							"name": {"constant_value": "tfsampler53.com"},
							"vpc": [{"vpc_id": {"references": [
								"aws_vpc.tf_sample_vpc.id",
								"aws_vpc.tf_sample_vpc",
							]}}],
						},
						"schema_version": 0,
					},
					{
						"address": "aws_s3_bucket.tf_sample_s3",
						"mode": "managed",
						"type": "aws_s3_bucket",
						"name": "tf_sample_s3",
						"provider_config_key": "aws",
						"expressions": {
							"bucket": {"references": ["local.bucket_name"]},
							"hosted_zone_id": {"references": [
								"aws_route53_zone.tf_sample_r53.id",
								"aws_route53_zone.tf_sample_r53",
							]},
							"tags": {"constant_value": {
								"Name": "My bucket",
								"Purpose": "Policy Library Development",
							}},
						},
						"schema_version": 0,
					},
					{
						"address": "aws_vpc.tf_sample_vpc",
						"mode": "managed",
						"type": "aws_vpc",
						"name": "tf_sample_vpc",
						"provider_config_key": "aws",
						"expressions": {
							"cidr_block": {"references": ["var.vpc_cidr"]},
							"tags": {"constant_value": {"Name": "tf_sample_vpc"}},
						},
						"schema_version": 1,
					},
					{
						"address": "random_string.random_val",
						"mode": "managed",
						"type": "random_string",
						"name": "random_val",
						"provider_config_key": "random",
						"expressions": {
							"length": {"constant_value": 4},
							"override_special": {"constant_value": ".-"},
							"special": {"constant_value": true},
							"upper": {"constant_value": false},
						},
						"schema_version": 2,
					},
				],
				"variables": {
					"region": {"default": "us-west-2"},
					"vpc_cidr": {"default": "178.0.0.0/16"},
				},
			},
		},
		"relevant_attributes": [
			{
				"resource": "aws_cloudfront_origin_access_identity.cdn_origin_access_identity",
				"attribute": ["cloudfront_access_identity_path"],
			},
			{
				"resource": "random_string.random_val",
				"attribute": ["result"],
			},
			{
				"resource": "aws_vpc.tf_sample_vpc",
				"attribute": ["id"],
			},
			{
				"resource": "aws_route53_zone.tf_sample_r53",
				"attribute": ["id"],
			},
			{
				"resource": "aws_s3_bucket.tf_sample_s3",
				"attribute": ["bucket_regional_domain_name"],
			},
		],
	}
}

input_cloudfront_distribution(web_acl_id) := x {
	x := {
		"format_version": "1.1",
		"terraform_version": "1.2.5",
		"variables": {
			"region": {"value": "us-west-2"},
			"vpc_cidr": {"value": "178.0.0.0/16"},
		},
		"planned_values": {"root_module": {"resources": [
			{
				"address": "aws_cloudfront_distribution.s3_distribution",
				"mode": "managed",
				"type": "aws_cloudfront_distribution",
				"name": "s3_distribution",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 1,
				"values": {
					"aliases": null,
					"comment": null,
					"custom_error_response": [],
					"default_cache_behavior": [{
						"allowed_methods": [
							"DELETE",
							"GET",
							"HEAD",
							"OPTIONS",
							"PATCH",
							"POST",
							"PUT",
						],
						"cache_policy_id": null,
						"cached_methods": [
							"GET",
							"HEAD",
						],
						"compress": false,
						"default_ttl": 3600,
						"field_level_encryption_id": null,
						"forwarded_values": [{
							"cookies": [{"forward": "none"}],
							"query_string": false,
						}],
						"function_association": [],
						"lambda_function_association": [],
						"max_ttl": 86400,
						"min_ttl": 0,
						"origin_request_policy_id": null,
						"realtime_log_config_arn": null,
						"response_headers_policy_id": null,
						"smooth_streaming": null,
						"target_origin_id": "myS3Origin",
						"viewer_protocol_policy": "allow-all",
					}],
					"default_root_object": null,
					"enabled": true,
					"http_version": "http2",
					"is_ipv6_enabled": false,
					"logging_config": [],
					"ordered_cache_behavior": [],
					"origin": [{
						"connection_attempts": 3,
						"connection_timeout": 10,
						"custom_header": [],
						"custom_origin_config": [],
						"origin_id": "myS3Origin",
						"origin_path": "",
						"origin_shield": [],
						"s3_origin_config": [{}],
					}],
					"origin_group": [],
					"price_class": "PriceClass_200",
					"restrictions": [{"geo_restriction": [{
						"locations": [
							"CA",
							"DE",
							"GB",
							"US",
						],
						"restriction_type": "whitelist",
					}]}],
					"retain_on_delete": false,
					"tags": {"Environment": "dev"},
					"tags_all": {"Environment": "dev"},
					"viewer_certificate": [{
						"acm_certificate_arn": null,
						"cloudfront_default_certificate": true,
						"iam_certificate_id": null,
						"minimum_protocol_version": "TLSv1",
						"ssl_support_method": null,
					}],
					"wait_for_deployment": true,
					"web_acl_id": web_acl_id,
				},
				"sensitive_values": {
					"custom_error_response": [],
					"default_cache_behavior": [{
						"allowed_methods": [
							false,
							false,
							false,
							false,
							false,
							false,
							false,
						],
						"cached_methods": [
							false,
							false,
						],
						"forwarded_values": [{
							"cookies": [{"whitelisted_names": []}],
							"headers": [],
							"query_string_cache_keys": [],
						}],
						"function_association": [],
						"lambda_function_association": [],
						"trusted_key_groups": [],
						"trusted_signers": [],
					}],
					"logging_config": [],
					"ordered_cache_behavior": [],
					"origin": [{
						"custom_header": [],
						"custom_origin_config": [],
						"origin_shield": [],
						"s3_origin_config": [{}],
					}],
					"origin_group": [],
					"restrictions": [{"geo_restriction": [{"locations": [
						false,
						false,
						false,
						false,
					]}]}],
					"tags": {},
					"tags_all": {},
					"trusted_key_groups": [],
					"trusted_signers": [],
					"viewer_certificate": [{}],
				},
			},
			{
				"address": "aws_cloudfront_origin_access_identity.cdn_origin_access_identity",
				"mode": "managed",
				"type": "aws_cloudfront_origin_access_identity",
				"name": "cdn_origin_access_identity",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 0,
				"values": {"comment": "aws_cloudfront_origin_access_identity"},
				"sensitive_values": {},
			},
			{
				"address": "aws_route53_zone.tf_sample_r53",
				"mode": "managed",
				"type": "aws_route53_zone",
				"name": "tf_sample_r53",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 0,
				"values": {
					"comment": "Managed by Terraform",
					"delegation_set_id": null,
					"force_destroy": false,
					"name": "tfsampler53.com",
					"tags": null,
					"vpc": [{}],
				},
				"sensitive_values": {
					"name_servers": [],
					"tags_all": {},
					"vpc": [{}],
				},
			},
			{
				"address": "aws_s3_bucket.tf_sample_s3",
				"mode": "managed",
				"type": "aws_s3_bucket",
				"name": "tf_sample_s3",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 0,
				"values": {
					"acl": "private",
					"bucket_prefix": null,
					"cors_rule": [],
					"force_destroy": false,
					"grant": [],
					"lifecycle_rule": [],
					"logging": [],
					"policy": null,
					"replication_configuration": [],
					"server_side_encryption_configuration": [],
					"tags": {
						"Name": "My bucket",
						"Purpose": "Policy Library Development",
					},
					"tags_all": {
						"Name": "My bucket",
						"Purpose": "Policy Library Development",
					},
					"website": [],
				},
				"sensitive_values": {
					"cors_rule": [],
					"grant": [],
					"lifecycle_rule": [],
					"logging": [],
					"object_lock_configuration": [],
					"replication_configuration": [],
					"server_side_encryption_configuration": [],
					"tags": {},
					"tags_all": {},
					"versioning": [],
					"website": [],
				},
			},
			{
				"address": "aws_vpc.tf_sample_vpc",
				"mode": "managed",
				"type": "aws_vpc",
				"name": "tf_sample_vpc",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"schema_version": 1,
				"values": {
					"assign_generated_ipv6_cidr_block": null,
					"cidr_block": "178.0.0.0/16",
					"enable_dns_support": true,
					"instance_tenancy": "default",
					"ipv4_ipam_pool_id": null,
					"ipv4_netmask_length": null,
					"ipv6_ipam_pool_id": null,
					"ipv6_netmask_length": null,
					"tags": {"Name": "tf_sample_vpc"},
					"tags_all": {"Name": "tf_sample_vpc"},
				},
				"sensitive_values": {
					"tags": {},
					"tags_all": {},
				},
			},
			{
				"address": "random_string.random_val",
				"mode": "managed",
				"type": "random_string",
				"name": "random_val",
				"provider_name": "registry.terraform.io/hashicorp/random",
				"schema_version": 2,
				"values": {
					"keepers": null,
					"length": 4,
					"lower": true,
					"min_lower": 0,
					"min_numeric": 0,
					"min_special": 0,
					"min_upper": 0,
					"number": true,
					"numeric": true,
					"override_special": ".-",
					"special": true,
					"upper": false,
				},
				"sensitive_values": {},
			},
		]}},
		"resource_changes": [
			{
				"address": "aws_cloudfront_distribution.s3_distribution",
				"mode": "managed",
				"type": "aws_cloudfront_distribution",
				"name": "s3_distribution",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"aliases": null,
						"comment": null,
						"custom_error_response": [],
						"default_cache_behavior": [{
							"allowed_methods": [
								"DELETE",
								"GET",
								"HEAD",
								"OPTIONS",
								"PATCH",
								"POST",
								"PUT",
							],
							"cache_policy_id": null,
							"cached_methods": [
								"GET",
								"HEAD",
							],
							"compress": false,
							"default_ttl": 3600,
							"field_level_encryption_id": null,
							"forwarded_values": [{
								"cookies": [{"forward": "none"}],
								"query_string": false,
							}],
							"function_association": [],
							"lambda_function_association": [],
							"max_ttl": 86400,
							"min_ttl": 0,
							"origin_request_policy_id": null,
							"realtime_log_config_arn": null,
							"response_headers_policy_id": null,
							"smooth_streaming": null,
							"target_origin_id": "myS3Origin",
							"viewer_protocol_policy": "allow-all",
						}],
						"default_root_object": null,
						"enabled": true,
						"http_version": "http2",
						"is_ipv6_enabled": false,
						"logging_config": [],
						"ordered_cache_behavior": [],
						"origin": [{
							"connection_attempts": 3,
							"connection_timeout": 10,
							"custom_header": [],
							"custom_origin_config": [],
							"origin_id": "myS3Origin",
							"origin_path": "",
							"origin_shield": [],
							"s3_origin_config": [{}],
						}],
						"origin_group": [],
						"price_class": "PriceClass_200",
						"restrictions": [{"geo_restriction": [{
							"locations": [
								"CA",
								"DE",
								"GB",
								"US",
							],
							"restriction_type": "whitelist",
						}]}],
						"retain_on_delete": false,
						"tags": {"Environment": "dev"},
						"tags_all": {"Environment": "dev"},
						"viewer_certificate": [{
							"acm_certificate_arn": null,
							"cloudfront_default_certificate": true,
							"iam_certificate_id": null,
							"minimum_protocol_version": "TLSv1",
							"ssl_support_method": null,
						}],
						"wait_for_deployment": true,
						"web_acl_id": web_acl_id,
					},
					"after_unknown": {
						"arn": true,
						"caller_reference": true,
						"custom_error_response": [],
						"default_cache_behavior": [{
							"allowed_methods": [
								false,
								false,
								false,
								false,
								false,
								false,
								false,
							],
							"cached_methods": [
								false,
								false,
							],
							"forwarded_values": [{
								"cookies": [{"whitelisted_names": true}],
								"headers": true,
								"query_string_cache_keys": true,
							}],
							"function_association": [],
							"lambda_function_association": [],
							"trusted_key_groups": true,
							"trusted_signers": true,
						}],
						"domain_name": true,
						"etag": true,
						"hosted_zone_id": true,
						"id": true,
						"in_progress_validation_batches": true,
						"last_modified_time": true,
						"logging_config": [],
						"ordered_cache_behavior": [],
						"origin": [{
							"custom_header": [],
							"custom_origin_config": [],
							"domain_name": true,
							"origin_shield": [],
							"s3_origin_config": [{"origin_access_identity": true}],
						}],
						"origin_group": [],
						"restrictions": [{"geo_restriction": [{"locations": [
							false,
							false,
							false,
							false,
						]}]}],
						"status": true,
						"tags": {},
						"tags_all": {},
						"trusted_key_groups": true,
						"trusted_signers": true,
						"viewer_certificate": [{}],
					},
					"before_sensitive": false,
					"after_sensitive": {
						"custom_error_response": [],
						"default_cache_behavior": [{
							"allowed_methods": [
								false,
								false,
								false,
								false,
								false,
								false,
								false,
							],
							"cached_methods": [
								false,
								false,
							],
							"forwarded_values": [{
								"cookies": [{"whitelisted_names": []}],
								"headers": [],
								"query_string_cache_keys": [],
							}],
							"function_association": [],
							"lambda_function_association": [],
							"trusted_key_groups": [],
							"trusted_signers": [],
						}],
						"logging_config": [],
						"ordered_cache_behavior": [],
						"origin": [{
							"custom_header": [],
							"custom_origin_config": [],
							"origin_shield": [],
							"s3_origin_config": [{}],
						}],
						"origin_group": [],
						"restrictions": [{"geo_restriction": [{"locations": [
							false,
							false,
							false,
							false,
						]}]}],
						"tags": {},
						"tags_all": {},
						"trusted_key_groups": [],
						"trusted_signers": [],
						"viewer_certificate": [{}],
					},
				},
			},
			{
				"address": "aws_cloudfront_origin_access_identity.cdn_origin_access_identity",
				"mode": "managed",
				"type": "aws_cloudfront_origin_access_identity",
				"name": "cdn_origin_access_identity",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {"comment": "aws_cloudfront_origin_access_identity"},
					"after_unknown": {
						"caller_reference": true,
						"cloudfront_access_identity_path": true,
						"etag": true,
						"iam_arn": true,
						"id": true,
						"s3_canonical_user_id": true,
					},
					"before_sensitive": false,
					"after_sensitive": {},
				},
			},
			{
				"address": "aws_route53_zone.tf_sample_r53",
				"mode": "managed",
				"type": "aws_route53_zone",
				"name": "tf_sample_r53",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"comment": "Managed by Terraform",
						"delegation_set_id": null,
						"force_destroy": false,
						"name": "tfsampler53.com",
						"tags": null,
						"vpc": [{}],
					},
					"after_unknown": {
						"arn": true,
						"id": true,
						"name_servers": true,
						"tags_all": true,
						"vpc": [{
							"vpc_id": true,
							"vpc_region": true,
						}],
						"zone_id": true,
					},
					"before_sensitive": false,
					"after_sensitive": {
						"name_servers": [],
						"tags_all": {},
						"vpc": [{}],
					},
				},
			},
			{
				"address": "aws_s3_bucket.tf_sample_s3",
				"mode": "managed",
				"type": "aws_s3_bucket",
				"name": "tf_sample_s3",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"acl": "private",
						"bucket_prefix": null,
						"cors_rule": [],
						"force_destroy": false,
						"grant": [],
						"lifecycle_rule": [],
						"logging": [],
						"policy": null,
						"replication_configuration": [],
						"server_side_encryption_configuration": [],
						"tags": {
							"Name": "My bucket",
							"Purpose": "Policy Library Development",
						},
						"tags_all": {
							"Name": "My bucket",
							"Purpose": "Policy Library Development",
						},
						"website": [],
					},
					"after_unknown": {
						"acceleration_status": true,
						"arn": true,
						"bucket": true,
						"bucket_domain_name": true,
						"bucket_regional_domain_name": true,
						"cors_rule": [],
						"grant": [],
						"hosted_zone_id": true,
						"id": true,
						"lifecycle_rule": [],
						"logging": [],
						"object_lock_configuration": true,
						"object_lock_enabled": true,
						"region": true,
						"replication_configuration": [],
						"request_payer": true,
						"server_side_encryption_configuration": [],
						"tags": {},
						"tags_all": {},
						"versioning": true,
						"website": [],
						"website_domain": true,
						"website_endpoint": true,
					},
					"before_sensitive": false,
					"after_sensitive": {
						"cors_rule": [],
						"grant": [],
						"lifecycle_rule": [],
						"logging": [],
						"object_lock_configuration": [],
						"replication_configuration": [],
						"server_side_encryption_configuration": [],
						"tags": {},
						"tags_all": {},
						"versioning": [],
						"website": [],
					},
				},
			},
			{
				"address": "aws_vpc.tf_sample_vpc",
				"mode": "managed",
				"type": "aws_vpc",
				"name": "tf_sample_vpc",
				"provider_name": "registry.terraform.io/hashicorp/aws",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"assign_generated_ipv6_cidr_block": null,
						"cidr_block": "178.0.0.0/16",
						"enable_dns_support": true,
						"instance_tenancy": "default",
						"ipv4_ipam_pool_id": null,
						"ipv4_netmask_length": null,
						"ipv6_ipam_pool_id": null,
						"ipv6_netmask_length": null,
						"tags": {"Name": "tf_sample_vpc"},
						"tags_all": {"Name": "tf_sample_vpc"},
					},
					"after_unknown": {
						"arn": true,
						"default_network_acl_id": true,
						"default_route_table_id": true,
						"default_security_group_id": true,
						"dhcp_options_id": true,
						"enable_classiclink": true,
						"enable_classiclink_dns_support": true,
						"enable_dns_hostnames": true,
						"id": true,
						"ipv6_association_id": true,
						"ipv6_cidr_block": true,
						"ipv6_cidr_block_network_border_group": true,
						"main_route_table_id": true,
						"owner_id": true,
						"tags": {},
						"tags_all": {},
					},
					"before_sensitive": false,
					"after_sensitive": {
						"tags": {},
						"tags_all": {},
					},
				},
			},
			{
				"address": "random_string.random_val",
				"mode": "managed",
				"type": "random_string",
				"name": "random_val",
				"provider_name": "registry.terraform.io/hashicorp/random",
				"change": {
					"actions": ["create"],
					"before": null,
					"after": {
						"keepers": null,
						"length": 4,
						"lower": true,
						"min_lower": 0,
						"min_numeric": 0,
						"min_special": 0,
						"min_upper": 0,
						"number": true,
						"numeric": true,
						"override_special": ".-",
						"special": true,
						"upper": false,
					},
					"after_unknown": {
						"id": true,
						"result": true,
					},
					"before_sensitive": false,
					"after_sensitive": {},
				},
			},
		],
		"configuration": {
			"provider_config": {
				"aws": {
					"name": "aws",
					"full_name": "registry.terraform.io/hashicorp/aws",
					"version_constraint": "~> 3.27",
					"expressions": {
						"profile": {"constant_value": "default"},
						"region": {"references": ["var.region"]},
					},
				},
				"random": {
					"name": "random",
					"full_name": "registry.terraform.io/hashicorp/random",
				},
			},
			"root_module": {
				"resources": [
					{
						"address": "aws_cloudfront_distribution.s3_distribution",
						"mode": "managed",
						"type": "aws_cloudfront_distribution",
						"name": "s3_distribution",
						"provider_config_key": "aws",
						"expressions": {
							"default_cache_behavior": [{
								"allowed_methods": {"constant_value": [
									"DELETE",
									"GET",
									"HEAD",
									"OPTIONS",
									"PATCH",
									"POST",
									"PUT",
								]},
								"cached_methods": {"constant_value": [
									"GET",
									"HEAD",
								]},
								"default_ttl": {"constant_value": 3600},
								"forwarded_values": [{
									"cookies": [{"forward": {"constant_value": "none"}}],
									"query_string": {"constant_value": false},
								}],
								"max_ttl": {"constant_value": 86400},
								"min_ttl": {"constant_value": 0},
								"target_origin_id": {"references": ["local.s3_origin_id"]},
								"viewer_protocol_policy": {"constant_value": "allow-all"},
							}],
							"enabled": {"constant_value": true},
							"origin": [{
								"domain_name": {"references": [
									"aws_s3_bucket.tf_sample_s3.bucket_regional_domain_name",
									"aws_s3_bucket.tf_sample_s3",
								]},
								"origin_id": {"references": ["local.s3_origin_id"]},
								"s3_origin_config": [{"origin_access_identity": {"references": [
									"aws_cloudfront_origin_access_identity.cdn_origin_access_identity.cloudfront_access_identity_path",
									"aws_cloudfront_origin_access_identity.cdn_origin_access_identity",
								]}}],
							}],
							"price_class": {"constant_value": "PriceClass_200"},
							"restrictions": [{"geo_restriction": [{
								"locations": {"constant_value": [
									"US",
									"CA",
									"GB",
									"DE",
								]},
								"restriction_type": {"constant_value": "whitelist"},
							}]}],
							"tags": {"constant_value": {"Environment": "dev"}},
							"viewer_certificate": [{"cloudfront_default_certificate": {"constant_value": true}}],
						},
						"schema_version": 1,
					},
					{
						"address": "aws_cloudfront_origin_access_identity.cdn_origin_access_identity",
						"mode": "managed",
						"type": "aws_cloudfront_origin_access_identity",
						"name": "cdn_origin_access_identity",
						"provider_config_key": "aws",
						"expressions": {"comment": {"constant_value": "aws_cloudfront_origin_access_identity"}},
						"schema_version": 0,
					},
					{
						"address": "aws_route53_zone.tf_sample_r53",
						"mode": "managed",
						"type": "aws_route53_zone",
						"name": "tf_sample_r53",
						"provider_config_key": "aws",
						"expressions": {
							"name": {"constant_value": "tfsampler53.com"},
							"vpc": [{"vpc_id": {"references": [
								"aws_vpc.tf_sample_vpc.id",
								"aws_vpc.tf_sample_vpc",
							]}}],
						},
						"schema_version": 0,
					},
					{
						"address": "aws_s3_bucket.tf_sample_s3",
						"mode": "managed",
						"type": "aws_s3_bucket",
						"name": "tf_sample_s3",
						"provider_config_key": "aws",
						"expressions": {
							"bucket": {"references": ["local.bucket_name"]},
							"hosted_zone_id": {"references": [
								"aws_route53_zone.tf_sample_r53.id",
								"aws_route53_zone.tf_sample_r53",
							]},
							"tags": {"constant_value": {
								"Name": "My bucket",
								"Purpose": "Policy Library Development",
							}},
						},
						"schema_version": 0,
					},
					{
						"address": "aws_vpc.tf_sample_vpc",
						"mode": "managed",
						"type": "aws_vpc",
						"name": "tf_sample_vpc",
						"provider_config_key": "aws",
						"expressions": {
							"cidr_block": {"references": ["var.vpc_cidr"]},
							"tags": {"constant_value": {"Name": "tf_sample_vpc"}},
						},
						"schema_version": 1,
					},
					{
						"address": "random_string.random_val",
						"mode": "managed",
						"type": "random_string",
						"name": "random_val",
						"provider_config_key": "random",
						"expressions": {
							"length": {"constant_value": 4},
							"override_special": {"constant_value": ".-"},
							"special": {"constant_value": true},
							"upper": {"constant_value": false},
						},
						"schema_version": 2,
					},
				],
				"variables": {
					"region": {"default": "us-west-2"},
					"vpc_cidr": {"default": "178.0.0.0/16"},
				},
			},
		},
		"relevant_attributes": [
			{
				"resource": "aws_cloudfront_origin_access_identity.cdn_origin_access_identity",
				"attribute": ["cloudfront_access_identity_path"],
			},
			{
				"resource": "random_string.random_val",
				"attribute": ["result"],
			},
			{
				"resource": "aws_vpc.tf_sample_vpc",
				"attribute": ["id"],
			},
			{
				"resource": "aws_route53_zone.tf_sample_r53",
				"attribute": ["id"],
			},
			{
				"resource": "aws_s3_bucket.tf_sample_s3",
				"attribute": ["bucket_regional_domain_name"],
			},
		],
	}
}
